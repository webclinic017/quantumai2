A new study created in memory with name: no-name-b017b596-a9f7-4bb7-84ad-fc6fe5ea5a1c
Trial 0 failed with parameters: {'learning_rate': 2.8249214589397216e-05, 'n_steps': 5255, 'total_timesteps': 1856152, 'gamma': 0.9180558895867634, 'gae_lambda': 0.9282750482402816, 'ent_coef': 0.01494313167276775, 'vf_coef': 0.1734104184823211, 'max_grad_norm': 0.30166019766110286, 'reward_scaling': 0.00024023696970949267, 'hmax': 65589, 'high_profit_bonus': 214, 'partial_sell_bonus': 3087, 'profit_threshold': 0.06424497818909397, 'sharpe_ratio_weight': 0.2565664203136918, 'loss_penalty_weight': 0.2515959109618655, 'short_selling_allowed': False} because of the following error: The value None could not be cast to float..
Trial 0 failed with value None.
Trial 1 failed with parameters: {'learning_rate': 8.662249006734342e-05, 'n_steps': 1384, 'total_timesteps': 2938511, 'gamma': 0.9196529097894472, 'gae_lambda': 0.9154140898697205, 'ent_coef': 0.010685548234674517, 'vf_coef': 0.28217258639397375, 'max_grad_norm': 0.11863717575724003, 'reward_scaling': 0.00018530774885582745, 'hmax': 42191, 'high_profit_bonus': 3031, 'partial_sell_bonus': 2196, 'profit_threshold': 0.029451620143901444, 'sharpe_ratio_weight': 0.29882389821994604, 'loss_penalty_weight': 0.5902511900022755, 'short_selling_allowed': True} because of the following error: The value None could not be cast to float..
Trial 1 failed with value None.
Trial 2 failed with parameters: {'learning_rate': 2.8211662031253607e-05, 'n_steps': 6058, 'total_timesteps': 800545, 'gamma': 0.9553882643993286, 'gae_lambda': 0.9273238793860826, 'ent_coef': 0.06540610139353774, 'vf_coef': 0.10617952644054221, 'max_grad_norm': 0.10497823541966786, 'reward_scaling': 0.0001918403790008194, 'hmax': 70227, 'high_profit_bonus': 4957, 'partial_sell_bonus': 5690, 'profit_threshold': 0.07185772976591369, 'sharpe_ratio_weight': 0.7599708557831801, 'loss_penalty_weight': 0.16525265930789948, 'short_selling_allowed': False} because of the following error: The value None could not be cast to float..
Trial 2 failed with value None.
Trial 3 failed with parameters: {'learning_rate': 2.466050042166775e-05, 'n_steps': 6452, 'total_timesteps': 1498277, 'gamma': 0.9836127610920951, 'gae_lambda': 0.9629808763568148, 'ent_coef': 0.035333479265350534, 'vf_coef': 0.1232608500182224, 'max_grad_norm': 0.2401277806420173, 'reward_scaling': 0.00015095431120474401, 'hmax': 40853, 'high_profit_bonus': 8683, 'partial_sell_bonus': 9200, 'profit_threshold': 0.024628750596219877, 'sharpe_ratio_weight': 0.2488580522673737, 'loss_penalty_weight': 0.23829116155394883, 'short_selling_allowed': False} because of the following error: The value None could not be cast to float..
Trial 3 failed with value None.
Trial 4 failed with parameters: {'learning_rate': 6.405628985923176e-05, 'n_steps': 7087, 'total_timesteps': 2838923, 'gamma': 0.9877649290975222, 'gae_lambda': 0.9734637986596111, 'ent_coef': 0.015060977925506787, 'vf_coef': 0.10734561901935584, 'max_grad_norm': 0.30669899621527535, 'reward_scaling': 9.842876652673399e-05, 'hmax': 43525, 'high_profit_bonus': 7987, 'partial_sell_bonus': 3241, 'profit_threshold': 0.09343360640738364, 'sharpe_ratio_weight': 0.5210743991590687, 'loss_penalty_weight': 0.11819630861614079, 'short_selling_allowed': False} because of the following error: The value None could not be cast to float..
Trial 4 failed with value None.
Trial 5 failed with parameters: {'learning_rate': 1.6022370512618304e-05, 'n_steps': 5484, 'total_timesteps': 1163641, 'gamma': 0.936059544148302, 'gae_lambda': 0.9849583950901806, 'ent_coef': 0.015389016510530667, 'vf_coef': 0.2160324157124265, 'max_grad_norm': 0.3287309432819238, 'reward_scaling': 5.1618992592234256e-05, 'hmax': 88282, 'high_profit_bonus': 7980, 'partial_sell_bonus': 1614, 'profit_threshold': 0.028135546636974842, 'sharpe_ratio_weight': 0.2969827877585457, 'loss_penalty_weight': 0.1016716032693121, 'short_selling_allowed': False} because of the following error: The value None could not be cast to float..
Trial 5 failed with value None.
Trial 6 failed with parameters: {'learning_rate': 7.57446851935448e-05, 'n_steps': 4519, 'total_timesteps': 2923478, 'gamma': 0.921308436577903, 'gae_lambda': 0.9955086435741395, 'ent_coef': 0.06889476531445562, 'vf_coef': 0.18715321136481125, 'max_grad_norm': 0.21127248704396678, 'reward_scaling': 0.0006453714620506479, 'hmax': 54696, 'high_profit_bonus': 1250, 'partial_sell_bonus': 3587, 'profit_threshold': 0.02710951467618107, 'sharpe_ratio_weight': 0.6065827222485232, 'loss_penalty_weight': 0.39128665886284236, 'short_selling_allowed': True} because of the following error: The value None could not be cast to float..
Trial 6 failed with value None.
Trial 7 failed with parameters: {'learning_rate': 2.1380848796355303e-05, 'n_steps': 3884, 'total_timesteps': 2834815, 'gamma': 0.9364084840663848, 'gae_lambda': 0.9363895441311141, 'ent_coef': 0.0886284331739423, 'vf_coef': 0.2138330402536985, 'max_grad_norm': 0.276418904880196, 'reward_scaling': 1.599487935328999e-05, 'hmax': 77135, 'high_profit_bonus': 3733, 'partial_sell_bonus': 7972, 'profit_threshold': 0.037683689694617536, 'sharpe_ratio_weight': 0.39277487008199186, 'loss_penalty_weight': 0.128582152039208, 'short_selling_allowed': True} because of the following error: The value None could not be cast to float..
Trial 7 failed with value None.
Trial 8 failed with parameters: {'learning_rate': 1.451781974540004e-05, 'n_steps': 2408, 'total_timesteps': 2369769, 'gamma': 0.9089023810022482, 'gae_lambda': 0.9752928799585763, 'ent_coef': 0.015409161030108968, 'vf_coef': 0.15032442885720962, 'max_grad_norm': 0.3439686116859734, 'reward_scaling': 0.0009533788797359588, 'hmax': 78849, 'high_profit_bonus': 8959, 'partial_sell_bonus': 8441, 'profit_threshold': 0.019268682149939372, 'sharpe_ratio_weight': 0.39314854092595397, 'loss_penalty_weight': 0.24923783381861367, 'short_selling_allowed': True} because of the following error: The value None could not be cast to float..
Trial 8 failed with value None.
Trial 9 failed with parameters: {'learning_rate': 5.254849111000044e-05, 'n_steps': 4526, 'total_timesteps': 1743530, 'gamma': 0.9062506918005963, 'gae_lambda': 0.9302900879585511, 'ent_coef': 0.024516621711040014, 'vf_coef': 0.18876034382920462, 'max_grad_norm': 0.20135470749747852, 'reward_scaling': 7.360241564676472e-05, 'hmax': 69823, 'high_profit_bonus': 6442, 'partial_sell_bonus': 5090, 'profit_threshold': 0.0378381006839643, 'sharpe_ratio_weight': 0.5433115225475781, 'loss_penalty_weight': 0.15687340267238728, 'short_selling_allowed': True} because of the following error: The value None could not be cast to float..
Trial 9 failed with value None.
A new study created in memory with name: no-name-928c5033-1615-413d-8b8a-3942f0fad533
Trial 0 failed with parameters: {'learning_rate': 3.091939331945435e-05, 'n_steps': 7990, 'total_timesteps': 947042, 'gamma': 0.9047707965852823, 'gae_lambda': 0.9375815789778662, 'ent_coef': 0.0572130040683989, 'vf_coef': 0.1199533887807846, 'max_grad_norm': 0.3054900930941058, 'reward_scaling': 0.0001037019550148187, 'hmax': 47652, 'high_profit_bonus': 7936, 'partial_sell_bonus': 1882, 'profit_threshold': 0.013453294766604552, 'sharpe_ratio_weight': 0.27152705160086277, 'loss_penalty_weight': 0.193729026142161, 'short_selling_allowed': False} because of the following error: The value None could not be cast to float..
Trial 0 failed with value None.
Trial 1 failed with parameters: {'learning_rate': 9.546781799847763e-05, 'n_steps': 8212, 'total_timesteps': 2875205, 'gamma': 0.9848887624719949, 'gae_lambda': 0.9616286997507637, 'ent_coef': 0.03530227920725282, 'vf_coef': 0.2760653107318408, 'max_grad_norm': 0.10240209561832016, 'reward_scaling': 4.204705690716847e-05, 'hmax': 94345, 'high_profit_bonus': 5067, 'partial_sell_bonus': 2446, 'profit_threshold': 0.016307298795075188, 'sharpe_ratio_weight': 0.2607871303949701, 'loss_penalty_weight': 0.4695906516939926, 'short_selling_allowed': True} because of the following error: The value None could not be cast to float..
Trial 1 failed with value None.
Trial 2 failed with parameters: {'learning_rate': 3.280724119840805e-05, 'n_steps': 2582, 'total_timesteps': 2211420, 'gamma': 0.9578821773887238, 'gae_lambda': 0.9273157324129216, 'ent_coef': 0.08857916986534853, 'vf_coef': 0.2551519342148616, 'max_grad_norm': 0.24941480302190516, 'reward_scaling': 0.0009486720020347473, 'hmax': 94587, 'high_profit_bonus': 2689, 'partial_sell_bonus': 6044, 'profit_threshold': 0.19511752056659293, 'sharpe_ratio_weight': 0.717275826046092, 'loss_penalty_weight': 0.11990873546520799, 'short_selling_allowed': False} because of the following error: The value None could not be cast to float..
Trial 2 failed with value None.
Trial 3 failed with parameters: {'learning_rate': 2.3541364155749643e-05, 'n_steps': 4912, 'total_timesteps': 2313492, 'gamma': 0.937794248477577, 'gae_lambda': 0.9584216987456268, 'ent_coef': 0.0813510853517255, 'vf_coef': 0.2781901083867907, 'max_grad_norm': 0.21535536804051503, 'reward_scaling': 0.0009068833993804875, 'hmax': 56546, 'high_profit_bonus': 4206, 'partial_sell_bonus': 2348, 'profit_threshold': 0.016117441763035856, 'sharpe_ratio_weight': 0.676903502130156, 'loss_penalty_weight': 0.2194277636196642, 'short_selling_allowed': True} because of the following error: KeyboardInterrupt().
Traceback (most recent call last):
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/hyperoptimizer/optunaoptimizer.py", line 87, in objective
    model.learn(total_timesteps=timesteps, callback=callbacks, tb_log_name="a2c_florian_any_name")
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/a2c/a2c.py", line 194, in learn
    return super().learn(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 259, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 178, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 197, in step
    return self.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 178, in step_wait
    obs, rewards, dones, infos = self.venv.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 58, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 168, in step
    begin_total_asset = self._calculate_total_asset(self.state)
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 160, in _calculate_total_asset
    return state[0] + sum(state[1:(self.stock_dim + 1)] * state[(self.stock_dim + 1):(self.stock_dim * 2 + 1)])
KeyboardInterrupt
Trial 3 failed with value None.
A new study created in memory with name: no-name-6e645b4d-8aab-470b-98f7-643b7445e79b
Trial 0 finished with value: -inf and parameters: {'learning_rate': 3.0717871961257454e-05, 'n_steps': 6210, 'total_timesteps': 2859946, 'gamma': 0.9538958633541117, 'gae_lambda': 0.9573338137782529, 'ent_coef': 0.015097477290545678, 'vf_coef': 0.12705835499579843, 'max_grad_norm': 0.23737267967642983, 'reward_scaling': 1.599132715479794e-05, 'hmax': 88932, 'high_profit_bonus': 3012, 'partial_sell_bonus': 5512, 'profit_threshold': 0.014525877167204214, 'sharpe_ratio_weight': 0.8698434163535029, 'loss_penalty_weight': 0.23216145006094568, 'short_selling_allowed': True}. Best is trial 0 with value: -inf.
Trial 1 finished with value: -inf and parameters: {'learning_rate': 2.1238289021860924e-05, 'n_steps': 3446, 'total_timesteps': 2069496, 'gamma': 0.9587436476699304, 'gae_lambda': 0.9257386987588012, 'ent_coef': 0.04729348683963667, 'vf_coef': 0.13498422861921064, 'max_grad_norm': 0.1779827976079501, 'reward_scaling': 0.000680845051179073, 'hmax': 93637, 'high_profit_bonus': 1174, 'partial_sell_bonus': 6803, 'profit_threshold': 0.026483365735167037, 'sharpe_ratio_weight': 0.324012762929422, 'loss_penalty_weight': 0.17067832370178235, 'short_selling_allowed': True}. Best is trial 0 with value: -inf.
Trial 2 finished with value: -inf and parameters: {'learning_rate': 3.981194951420112e-05, 'n_steps': 4963, 'total_timesteps': 2525775, 'gamma': 0.9417822327192102, 'gae_lambda': 0.9070636703345379, 'ent_coef': 0.010295616299317554, 'vf_coef': 0.2715822091754108, 'max_grad_norm': 0.15805225249236024, 'reward_scaling': 5.386893426106068e-05, 'hmax': 79249, 'high_profit_bonus': 6513, 'partial_sell_bonus': 6128, 'profit_threshold': 0.11941523206242109, 'sharpe_ratio_weight': 0.2488092195667286, 'loss_penalty_weight': 0.2603709555817008, 'short_selling_allowed': False}. Best is trial 0 with value: -inf.
Trial 3 finished with value: -inf and parameters: {'learning_rate': 7.899871792272351e-05, 'n_steps': 5343, 'total_timesteps': 2668791, 'gamma': 0.9154966790564275, 'gae_lambda': 0.9052684579035216, 'ent_coef': 0.026055118348415476, 'vf_coef': 0.18624711825444276, 'max_grad_norm': 0.24631687962787902, 'reward_scaling': 3.290417503561761e-05, 'hmax': 49222, 'high_profit_bonus': 8997, 'partial_sell_bonus': 7434, 'profit_threshold': 0.07019474194821695, 'sharpe_ratio_weight': 0.6665325313409778, 'loss_penalty_weight': 0.2782448661712368, 'short_selling_allowed': True}. Best is trial 0 with value: -inf.
Trial 4 finished with value: -inf and parameters: {'learning_rate': 3.678375246310577e-05, 'n_steps': 1028, 'total_timesteps': 2233132, 'gamma': 0.9653484546842521, 'gae_lambda': 0.9976082588385099, 'ent_coef': 0.01074291415516241, 'vf_coef': 0.12027132499643063, 'max_grad_norm': 0.31579582579376136, 'reward_scaling': 2.6224100778072328e-05, 'hmax': 95712, 'high_profit_bonus': 9919, 'partial_sell_bonus': 2119, 'profit_threshold': 0.16499334103015384, 'sharpe_ratio_weight': 0.3440731025734893, 'loss_penalty_weight': 0.2926375045416371, 'short_selling_allowed': False}. Best is trial 0 with value: -inf.
Trial 5 finished with value: -inf and parameters: {'learning_rate': 9.153589391793833e-05, 'n_steps': 9019, 'total_timesteps': 2783638, 'gamma': 0.9500207651516497, 'gae_lambda': 0.9662992526230153, 'ent_coef': 0.0619223114452882, 'vf_coef': 0.2975075997166922, 'max_grad_norm': 0.1751462958028696, 'reward_scaling': 5.689345193387597e-05, 'hmax': 91290, 'high_profit_bonus': 6741, 'partial_sell_bonus': 5968, 'profit_threshold': 0.10457338996689662, 'sharpe_ratio_weight': 0.493423836666615, 'loss_penalty_weight': 0.4751264228610676, 'short_selling_allowed': False}. Best is trial 0 with value: -inf.
Trial 6 finished with value: -inf and parameters: {'learning_rate': 1.3858517612283969e-05, 'n_steps': 9502, 'total_timesteps': 1430513, 'gamma': 0.9131796151839627, 'gae_lambda': 0.9099427061397835, 'ent_coef': 0.0821301344638031, 'vf_coef': 0.16058831736889287, 'max_grad_norm': 0.1455831924288016, 'reward_scaling': 0.0007671769901386997, 'hmax': 78164, 'high_profit_bonus': 8364, 'partial_sell_bonus': 5623, 'profit_threshold': 0.08431509650844156, 'sharpe_ratio_weight': 0.4128513864292445, 'loss_penalty_weight': 0.33430579505618535, 'short_selling_allowed': True}. Best is trial 0 with value: -inf.
Trial 7 finished with value: -inf and parameters: {'learning_rate': 2.649592801044135e-05, 'n_steps': 6413, 'total_timesteps': 1014342, 'gamma': 0.9921836241495323, 'gae_lambda': 0.9198680157975786, 'ent_coef': 0.028560134697276352, 'vf_coef': 0.20222624649448542, 'max_grad_norm': 0.13949060524824436, 'reward_scaling': 8.52572622157502e-05, 'hmax': 66789, 'high_profit_bonus': 8979, 'partial_sell_bonus': 2360, 'profit_threshold': 0.03511204303540305, 'sharpe_ratio_weight': 0.4790399483104941, 'loss_penalty_weight': 0.10795238277240335, 'short_selling_allowed': True}. Best is trial 0 with value: -inf.
Trial 8 failed with parameters: {'learning_rate': 6.479742958139122e-05, 'n_steps': 6683, 'total_timesteps': 1498805, 'gamma': 0.93701492378449, 'gae_lambda': 0.9745588735094949, 'ent_coef': 0.09132771895904962, 'vf_coef': 0.22259477925104962, 'max_grad_norm': 0.2059781901359763, 'reward_scaling': 0.00024355493943657846, 'hmax': 84602, 'high_profit_bonus': 3712, 'partial_sell_bonus': 6886, 'profit_threshold': 0.07156594506033122, 'sharpe_ratio_weight': 0.5408831223567403, 'loss_penalty_weight': 0.295365261899166, 'short_selling_allowed': True} because of the following error: KeyboardInterrupt().
Traceback (most recent call last):
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/hyperoptimizer/optunaoptimizer.py", line 87, in objective
    model.learn(total_timesteps=timesteps, callback=callbacks, tb_log_name="a2c_florian_any_name")
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/a2c/a2c.py", line 194, in learn
    return super().learn(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 259, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 178, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 197, in step
    return self.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 178, in step_wait
    obs, rewards, dones, infos = self.venv.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 58, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 184, in step
    self.date_memory.append(self._get_date())
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 320, in _get_date
    if len(self.df.tic.unique()) > 1:
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/series.py", line 2194, in unique
    return super().unique()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/base.py", line 1030, in unique
    result = algorithms.unique1d(values)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/algorithms.py", line 390, in unique
    return unique_with_mask(values)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/algorithms.py", line 429, in unique_with_mask
    uniques = table.unique(values)
KeyboardInterrupt
Trial 8 failed with value None.
A new study created in memory with name: no-name-ff6e93c0-b10d-44b2-a504-156e65f3e716
Trial 0 failed with parameters: {'learning_rate': 8.306370344749333e-05, 'n_steps': 1586, 'total_timesteps': 2113155, 'gamma': 0.9078028246381973, 'gae_lambda': 0.9871224745413298, 'ent_coef': 0.016339335376241538, 'vf_coef': 0.28295351892177023, 'max_grad_norm': 0.21329977130277272, 'reward_scaling': 7.689029748800124e-05, 'hmax': 61136, 'high_profit_bonus': 4967, 'partial_sell_bonus': 3591, 'profit_threshold': 0.028978129824632187, 'sharpe_ratio_weight': 0.6114479367849075, 'loss_penalty_weight': 0.3379606578742139, 'short_selling_allowed': True} because of the following error: KeyboardInterrupt().
Traceback (most recent call last):
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/hyperoptimizer/optunaoptimizer.py", line 87, in objective
    model.learn(total_timesteps=timesteps, callback=callbacks, tb_log_name="a2c_florian_any_name")
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/a2c/a2c.py", line 194, in learn
    return super().learn(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 259, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 178, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 197, in step
    return self.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 178, in step_wait
    obs, rewards, dones, infos = self.venv.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 58, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 164, in step
    self._handle_terminal_condition()
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 415, in _handle_terminal_condition
    df_total_value["date"] = self.date_memory
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/frame.py", line 3950, in __setitem__
    self._set_item(key, value)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/frame.py", line 4143, in _set_item
    value = self._sanitize_column(value)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/frame.py", line 4871, in _sanitize_column
    return sanitize_array(value, self.index, copy=True, allow_2d=True)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/construction.py", line 605, in sanitize_array
    subarr = maybe_infer_to_datetimelike(subarr)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/dtypes/cast.py", line 1204, in maybe_infer_to_datetimelike
    return lib.maybe_convert_objects(  # type: ignore[return-value]
  File "pandas/_libs/lib.pyx", line 2567, in pandas._libs.lib.maybe_convert_objects
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/indexes/datetimes.py", line 339, in __new__
    dtarr = DatetimeArray._from_sequence_not_strict(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/arrays/datetimes.py", line 333, in _from_sequence_not_strict
    subarr, tz, inferred_freq = _sequence_to_dt64ns(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/arrays/datetimes.py", line 2057, in _sequence_to_dt64ns
    data, inferred_tz = objects_to_datetime64ns(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/arrays/datetimes.py", line 2177, in objects_to_datetime64ns
    result, tz_parsed = tslib.array_to_datetime(
KeyboardInterrupt
Trial 0 failed with value None.
A new study created in memory with name: no-name-3ec164f3-480e-46bc-b584-4b02502efffe
