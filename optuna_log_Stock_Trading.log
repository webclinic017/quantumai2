A new study created in memory with name: no-name-b017b596-a9f7-4bb7-84ad-fc6fe5ea5a1c
Trial 0 failed with parameters: {'learning_rate': 2.8249214589397216e-05, 'n_steps': 5255, 'total_timesteps': 1856152, 'gamma': 0.9180558895867634, 'gae_lambda': 0.9282750482402816, 'ent_coef': 0.01494313167276775, 'vf_coef': 0.1734104184823211, 'max_grad_norm': 0.30166019766110286, 'reward_scaling': 0.00024023696970949267, 'hmax': 65589, 'high_profit_bonus': 214, 'partial_sell_bonus': 3087, 'profit_threshold': 0.06424497818909397, 'sharpe_ratio_weight': 0.2565664203136918, 'loss_penalty_weight': 0.2515959109618655, 'short_selling_allowed': False} because of the following error: The value None could not be cast to float..
Trial 0 failed with value None.
Trial 1 failed with parameters: {'learning_rate': 8.662249006734342e-05, 'n_steps': 1384, 'total_timesteps': 2938511, 'gamma': 0.9196529097894472, 'gae_lambda': 0.9154140898697205, 'ent_coef': 0.010685548234674517, 'vf_coef': 0.28217258639397375, 'max_grad_norm': 0.11863717575724003, 'reward_scaling': 0.00018530774885582745, 'hmax': 42191, 'high_profit_bonus': 3031, 'partial_sell_bonus': 2196, 'profit_threshold': 0.029451620143901444, 'sharpe_ratio_weight': 0.29882389821994604, 'loss_penalty_weight': 0.5902511900022755, 'short_selling_allowed': True} because of the following error: The value None could not be cast to float..
Trial 1 failed with value None.
Trial 2 failed with parameters: {'learning_rate': 2.8211662031253607e-05, 'n_steps': 6058, 'total_timesteps': 800545, 'gamma': 0.9553882643993286, 'gae_lambda': 0.9273238793860826, 'ent_coef': 0.06540610139353774, 'vf_coef': 0.10617952644054221, 'max_grad_norm': 0.10497823541966786, 'reward_scaling': 0.0001918403790008194, 'hmax': 70227, 'high_profit_bonus': 4957, 'partial_sell_bonus': 5690, 'profit_threshold': 0.07185772976591369, 'sharpe_ratio_weight': 0.7599708557831801, 'loss_penalty_weight': 0.16525265930789948, 'short_selling_allowed': False} because of the following error: The value None could not be cast to float..
Trial 2 failed with value None.
Trial 3 failed with parameters: {'learning_rate': 2.466050042166775e-05, 'n_steps': 6452, 'total_timesteps': 1498277, 'gamma': 0.9836127610920951, 'gae_lambda': 0.9629808763568148, 'ent_coef': 0.035333479265350534, 'vf_coef': 0.1232608500182224, 'max_grad_norm': 0.2401277806420173, 'reward_scaling': 0.00015095431120474401, 'hmax': 40853, 'high_profit_bonus': 8683, 'partial_sell_bonus': 9200, 'profit_threshold': 0.024628750596219877, 'sharpe_ratio_weight': 0.2488580522673737, 'loss_penalty_weight': 0.23829116155394883, 'short_selling_allowed': False} because of the following error: The value None could not be cast to float..
Trial 3 failed with value None.
Trial 4 failed with parameters: {'learning_rate': 6.405628985923176e-05, 'n_steps': 7087, 'total_timesteps': 2838923, 'gamma': 0.9877649290975222, 'gae_lambda': 0.9734637986596111, 'ent_coef': 0.015060977925506787, 'vf_coef': 0.10734561901935584, 'max_grad_norm': 0.30669899621527535, 'reward_scaling': 9.842876652673399e-05, 'hmax': 43525, 'high_profit_bonus': 7987, 'partial_sell_bonus': 3241, 'profit_threshold': 0.09343360640738364, 'sharpe_ratio_weight': 0.5210743991590687, 'loss_penalty_weight': 0.11819630861614079, 'short_selling_allowed': False} because of the following error: The value None could not be cast to float..
Trial 4 failed with value None.
Trial 5 failed with parameters: {'learning_rate': 1.6022370512618304e-05, 'n_steps': 5484, 'total_timesteps': 1163641, 'gamma': 0.936059544148302, 'gae_lambda': 0.9849583950901806, 'ent_coef': 0.015389016510530667, 'vf_coef': 0.2160324157124265, 'max_grad_norm': 0.3287309432819238, 'reward_scaling': 5.1618992592234256e-05, 'hmax': 88282, 'high_profit_bonus': 7980, 'partial_sell_bonus': 1614, 'profit_threshold': 0.028135546636974842, 'sharpe_ratio_weight': 0.2969827877585457, 'loss_penalty_weight': 0.1016716032693121, 'short_selling_allowed': False} because of the following error: The value None could not be cast to float..
Trial 5 failed with value None.
Trial 6 failed with parameters: {'learning_rate': 7.57446851935448e-05, 'n_steps': 4519, 'total_timesteps': 2923478, 'gamma': 0.921308436577903, 'gae_lambda': 0.9955086435741395, 'ent_coef': 0.06889476531445562, 'vf_coef': 0.18715321136481125, 'max_grad_norm': 0.21127248704396678, 'reward_scaling': 0.0006453714620506479, 'hmax': 54696, 'high_profit_bonus': 1250, 'partial_sell_bonus': 3587, 'profit_threshold': 0.02710951467618107, 'sharpe_ratio_weight': 0.6065827222485232, 'loss_penalty_weight': 0.39128665886284236, 'short_selling_allowed': True} because of the following error: The value None could not be cast to float..
Trial 6 failed with value None.
Trial 7 failed with parameters: {'learning_rate': 2.1380848796355303e-05, 'n_steps': 3884, 'total_timesteps': 2834815, 'gamma': 0.9364084840663848, 'gae_lambda': 0.9363895441311141, 'ent_coef': 0.0886284331739423, 'vf_coef': 0.2138330402536985, 'max_grad_norm': 0.276418904880196, 'reward_scaling': 1.599487935328999e-05, 'hmax': 77135, 'high_profit_bonus': 3733, 'partial_sell_bonus': 7972, 'profit_threshold': 0.037683689694617536, 'sharpe_ratio_weight': 0.39277487008199186, 'loss_penalty_weight': 0.128582152039208, 'short_selling_allowed': True} because of the following error: The value None could not be cast to float..
Trial 7 failed with value None.
Trial 8 failed with parameters: {'learning_rate': 1.451781974540004e-05, 'n_steps': 2408, 'total_timesteps': 2369769, 'gamma': 0.9089023810022482, 'gae_lambda': 0.9752928799585763, 'ent_coef': 0.015409161030108968, 'vf_coef': 0.15032442885720962, 'max_grad_norm': 0.3439686116859734, 'reward_scaling': 0.0009533788797359588, 'hmax': 78849, 'high_profit_bonus': 8959, 'partial_sell_bonus': 8441, 'profit_threshold': 0.019268682149939372, 'sharpe_ratio_weight': 0.39314854092595397, 'loss_penalty_weight': 0.24923783381861367, 'short_selling_allowed': True} because of the following error: The value None could not be cast to float..
Trial 8 failed with value None.
Trial 9 failed with parameters: {'learning_rate': 5.254849111000044e-05, 'n_steps': 4526, 'total_timesteps': 1743530, 'gamma': 0.9062506918005963, 'gae_lambda': 0.9302900879585511, 'ent_coef': 0.024516621711040014, 'vf_coef': 0.18876034382920462, 'max_grad_norm': 0.20135470749747852, 'reward_scaling': 7.360241564676472e-05, 'hmax': 69823, 'high_profit_bonus': 6442, 'partial_sell_bonus': 5090, 'profit_threshold': 0.0378381006839643, 'sharpe_ratio_weight': 0.5433115225475781, 'loss_penalty_weight': 0.15687340267238728, 'short_selling_allowed': True} because of the following error: The value None could not be cast to float..
Trial 9 failed with value None.
A new study created in memory with name: no-name-928c5033-1615-413d-8b8a-3942f0fad533
Trial 0 failed with parameters: {'learning_rate': 3.091939331945435e-05, 'n_steps': 7990, 'total_timesteps': 947042, 'gamma': 0.9047707965852823, 'gae_lambda': 0.9375815789778662, 'ent_coef': 0.0572130040683989, 'vf_coef': 0.1199533887807846, 'max_grad_norm': 0.3054900930941058, 'reward_scaling': 0.0001037019550148187, 'hmax': 47652, 'high_profit_bonus': 7936, 'partial_sell_bonus': 1882, 'profit_threshold': 0.013453294766604552, 'sharpe_ratio_weight': 0.27152705160086277, 'loss_penalty_weight': 0.193729026142161, 'short_selling_allowed': False} because of the following error: The value None could not be cast to float..
Trial 0 failed with value None.
Trial 1 failed with parameters: {'learning_rate': 9.546781799847763e-05, 'n_steps': 8212, 'total_timesteps': 2875205, 'gamma': 0.9848887624719949, 'gae_lambda': 0.9616286997507637, 'ent_coef': 0.03530227920725282, 'vf_coef': 0.2760653107318408, 'max_grad_norm': 0.10240209561832016, 'reward_scaling': 4.204705690716847e-05, 'hmax': 94345, 'high_profit_bonus': 5067, 'partial_sell_bonus': 2446, 'profit_threshold': 0.016307298795075188, 'sharpe_ratio_weight': 0.2607871303949701, 'loss_penalty_weight': 0.4695906516939926, 'short_selling_allowed': True} because of the following error: The value None could not be cast to float..
Trial 1 failed with value None.
Trial 2 failed with parameters: {'learning_rate': 3.280724119840805e-05, 'n_steps': 2582, 'total_timesteps': 2211420, 'gamma': 0.9578821773887238, 'gae_lambda': 0.9273157324129216, 'ent_coef': 0.08857916986534853, 'vf_coef': 0.2551519342148616, 'max_grad_norm': 0.24941480302190516, 'reward_scaling': 0.0009486720020347473, 'hmax': 94587, 'high_profit_bonus': 2689, 'partial_sell_bonus': 6044, 'profit_threshold': 0.19511752056659293, 'sharpe_ratio_weight': 0.717275826046092, 'loss_penalty_weight': 0.11990873546520799, 'short_selling_allowed': False} because of the following error: The value None could not be cast to float..
Trial 2 failed with value None.
Trial 3 failed with parameters: {'learning_rate': 2.3541364155749643e-05, 'n_steps': 4912, 'total_timesteps': 2313492, 'gamma': 0.937794248477577, 'gae_lambda': 0.9584216987456268, 'ent_coef': 0.0813510853517255, 'vf_coef': 0.2781901083867907, 'max_grad_norm': 0.21535536804051503, 'reward_scaling': 0.0009068833993804875, 'hmax': 56546, 'high_profit_bonus': 4206, 'partial_sell_bonus': 2348, 'profit_threshold': 0.016117441763035856, 'sharpe_ratio_weight': 0.676903502130156, 'loss_penalty_weight': 0.2194277636196642, 'short_selling_allowed': True} because of the following error: KeyboardInterrupt().
Traceback (most recent call last):
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/hyperoptimizer/optunaoptimizer.py", line 87, in objective
    model.learn(total_timesteps=timesteps, callback=callbacks, tb_log_name="a2c_florian_any_name")
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/a2c/a2c.py", line 194, in learn
    return super().learn(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 259, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 178, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 197, in step
    return self.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 178, in step_wait
    obs, rewards, dones, infos = self.venv.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 58, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 168, in step
    begin_total_asset = self._calculate_total_asset(self.state)
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 160, in _calculate_total_asset
    return state[0] + sum(state[1:(self.stock_dim + 1)] * state[(self.stock_dim + 1):(self.stock_dim * 2 + 1)])
KeyboardInterrupt
Trial 3 failed with value None.
A new study created in memory with name: no-name-6e645b4d-8aab-470b-98f7-643b7445e79b
Trial 0 finished with value: -inf and parameters: {'learning_rate': 3.0717871961257454e-05, 'n_steps': 6210, 'total_timesteps': 2859946, 'gamma': 0.9538958633541117, 'gae_lambda': 0.9573338137782529, 'ent_coef': 0.015097477290545678, 'vf_coef': 0.12705835499579843, 'max_grad_norm': 0.23737267967642983, 'reward_scaling': 1.599132715479794e-05, 'hmax': 88932, 'high_profit_bonus': 3012, 'partial_sell_bonus': 5512, 'profit_threshold': 0.014525877167204214, 'sharpe_ratio_weight': 0.8698434163535029, 'loss_penalty_weight': 0.23216145006094568, 'short_selling_allowed': True}. Best is trial 0 with value: -inf.
Trial 1 finished with value: -inf and parameters: {'learning_rate': 2.1238289021860924e-05, 'n_steps': 3446, 'total_timesteps': 2069496, 'gamma': 0.9587436476699304, 'gae_lambda': 0.9257386987588012, 'ent_coef': 0.04729348683963667, 'vf_coef': 0.13498422861921064, 'max_grad_norm': 0.1779827976079501, 'reward_scaling': 0.000680845051179073, 'hmax': 93637, 'high_profit_bonus': 1174, 'partial_sell_bonus': 6803, 'profit_threshold': 0.026483365735167037, 'sharpe_ratio_weight': 0.324012762929422, 'loss_penalty_weight': 0.17067832370178235, 'short_selling_allowed': True}. Best is trial 0 with value: -inf.
Trial 2 finished with value: -inf and parameters: {'learning_rate': 3.981194951420112e-05, 'n_steps': 4963, 'total_timesteps': 2525775, 'gamma': 0.9417822327192102, 'gae_lambda': 0.9070636703345379, 'ent_coef': 0.010295616299317554, 'vf_coef': 0.2715822091754108, 'max_grad_norm': 0.15805225249236024, 'reward_scaling': 5.386893426106068e-05, 'hmax': 79249, 'high_profit_bonus': 6513, 'partial_sell_bonus': 6128, 'profit_threshold': 0.11941523206242109, 'sharpe_ratio_weight': 0.2488092195667286, 'loss_penalty_weight': 0.2603709555817008, 'short_selling_allowed': False}. Best is trial 0 with value: -inf.
Trial 3 finished with value: -inf and parameters: {'learning_rate': 7.899871792272351e-05, 'n_steps': 5343, 'total_timesteps': 2668791, 'gamma': 0.9154966790564275, 'gae_lambda': 0.9052684579035216, 'ent_coef': 0.026055118348415476, 'vf_coef': 0.18624711825444276, 'max_grad_norm': 0.24631687962787902, 'reward_scaling': 3.290417503561761e-05, 'hmax': 49222, 'high_profit_bonus': 8997, 'partial_sell_bonus': 7434, 'profit_threshold': 0.07019474194821695, 'sharpe_ratio_weight': 0.6665325313409778, 'loss_penalty_weight': 0.2782448661712368, 'short_selling_allowed': True}. Best is trial 0 with value: -inf.
Trial 4 finished with value: -inf and parameters: {'learning_rate': 3.678375246310577e-05, 'n_steps': 1028, 'total_timesteps': 2233132, 'gamma': 0.9653484546842521, 'gae_lambda': 0.9976082588385099, 'ent_coef': 0.01074291415516241, 'vf_coef': 0.12027132499643063, 'max_grad_norm': 0.31579582579376136, 'reward_scaling': 2.6224100778072328e-05, 'hmax': 95712, 'high_profit_bonus': 9919, 'partial_sell_bonus': 2119, 'profit_threshold': 0.16499334103015384, 'sharpe_ratio_weight': 0.3440731025734893, 'loss_penalty_weight': 0.2926375045416371, 'short_selling_allowed': False}. Best is trial 0 with value: -inf.
Trial 5 finished with value: -inf and parameters: {'learning_rate': 9.153589391793833e-05, 'n_steps': 9019, 'total_timesteps': 2783638, 'gamma': 0.9500207651516497, 'gae_lambda': 0.9662992526230153, 'ent_coef': 0.0619223114452882, 'vf_coef': 0.2975075997166922, 'max_grad_norm': 0.1751462958028696, 'reward_scaling': 5.689345193387597e-05, 'hmax': 91290, 'high_profit_bonus': 6741, 'partial_sell_bonus': 5968, 'profit_threshold': 0.10457338996689662, 'sharpe_ratio_weight': 0.493423836666615, 'loss_penalty_weight': 0.4751264228610676, 'short_selling_allowed': False}. Best is trial 0 with value: -inf.
Trial 6 finished with value: -inf and parameters: {'learning_rate': 1.3858517612283969e-05, 'n_steps': 9502, 'total_timesteps': 1430513, 'gamma': 0.9131796151839627, 'gae_lambda': 0.9099427061397835, 'ent_coef': 0.0821301344638031, 'vf_coef': 0.16058831736889287, 'max_grad_norm': 0.1455831924288016, 'reward_scaling': 0.0007671769901386997, 'hmax': 78164, 'high_profit_bonus': 8364, 'partial_sell_bonus': 5623, 'profit_threshold': 0.08431509650844156, 'sharpe_ratio_weight': 0.4128513864292445, 'loss_penalty_weight': 0.33430579505618535, 'short_selling_allowed': True}. Best is trial 0 with value: -inf.
Trial 7 finished with value: -inf and parameters: {'learning_rate': 2.649592801044135e-05, 'n_steps': 6413, 'total_timesteps': 1014342, 'gamma': 0.9921836241495323, 'gae_lambda': 0.9198680157975786, 'ent_coef': 0.028560134697276352, 'vf_coef': 0.20222624649448542, 'max_grad_norm': 0.13949060524824436, 'reward_scaling': 8.52572622157502e-05, 'hmax': 66789, 'high_profit_bonus': 8979, 'partial_sell_bonus': 2360, 'profit_threshold': 0.03511204303540305, 'sharpe_ratio_weight': 0.4790399483104941, 'loss_penalty_weight': 0.10795238277240335, 'short_selling_allowed': True}. Best is trial 0 with value: -inf.
Trial 8 failed with parameters: {'learning_rate': 6.479742958139122e-05, 'n_steps': 6683, 'total_timesteps': 1498805, 'gamma': 0.93701492378449, 'gae_lambda': 0.9745588735094949, 'ent_coef': 0.09132771895904962, 'vf_coef': 0.22259477925104962, 'max_grad_norm': 0.2059781901359763, 'reward_scaling': 0.00024355493943657846, 'hmax': 84602, 'high_profit_bonus': 3712, 'partial_sell_bonus': 6886, 'profit_threshold': 0.07156594506033122, 'sharpe_ratio_weight': 0.5408831223567403, 'loss_penalty_weight': 0.295365261899166, 'short_selling_allowed': True} because of the following error: KeyboardInterrupt().
Traceback (most recent call last):
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/hyperoptimizer/optunaoptimizer.py", line 87, in objective
    model.learn(total_timesteps=timesteps, callback=callbacks, tb_log_name="a2c_florian_any_name")
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/a2c/a2c.py", line 194, in learn
    return super().learn(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 259, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 178, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 197, in step
    return self.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 178, in step_wait
    obs, rewards, dones, infos = self.venv.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 58, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 184, in step
    self.date_memory.append(self._get_date())
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 320, in _get_date
    if len(self.df.tic.unique()) > 1:
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/series.py", line 2194, in unique
    return super().unique()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/base.py", line 1030, in unique
    result = algorithms.unique1d(values)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/algorithms.py", line 390, in unique
    return unique_with_mask(values)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/algorithms.py", line 429, in unique_with_mask
    uniques = table.unique(values)
KeyboardInterrupt
Trial 8 failed with value None.
A new study created in memory with name: no-name-ff6e93c0-b10d-44b2-a504-156e65f3e716
Trial 0 failed with parameters: {'learning_rate': 8.306370344749333e-05, 'n_steps': 1586, 'total_timesteps': 2113155, 'gamma': 0.9078028246381973, 'gae_lambda': 0.9871224745413298, 'ent_coef': 0.016339335376241538, 'vf_coef': 0.28295351892177023, 'max_grad_norm': 0.21329977130277272, 'reward_scaling': 7.689029748800124e-05, 'hmax': 61136, 'high_profit_bonus': 4967, 'partial_sell_bonus': 3591, 'profit_threshold': 0.028978129824632187, 'sharpe_ratio_weight': 0.6114479367849075, 'loss_penalty_weight': 0.3379606578742139, 'short_selling_allowed': True} because of the following error: KeyboardInterrupt().
Traceback (most recent call last):
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/hyperoptimizer/optunaoptimizer.py", line 87, in objective
    model.learn(total_timesteps=timesteps, callback=callbacks, tb_log_name="a2c_florian_any_name")
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/a2c/a2c.py", line 194, in learn
    return super().learn(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 259, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 178, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 197, in step
    return self.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 178, in step_wait
    obs, rewards, dones, infos = self.venv.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 58, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 164, in step
    self._handle_terminal_condition()
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 415, in _handle_terminal_condition
    df_total_value["date"] = self.date_memory
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/frame.py", line 3950, in __setitem__
    self._set_item(key, value)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/frame.py", line 4143, in _set_item
    value = self._sanitize_column(value)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/frame.py", line 4871, in _sanitize_column
    return sanitize_array(value, self.index, copy=True, allow_2d=True)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/construction.py", line 605, in sanitize_array
    subarr = maybe_infer_to_datetimelike(subarr)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/dtypes/cast.py", line 1204, in maybe_infer_to_datetimelike
    return lib.maybe_convert_objects(  # type: ignore[return-value]
  File "pandas/_libs/lib.pyx", line 2567, in pandas._libs.lib.maybe_convert_objects
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/indexes/datetimes.py", line 339, in __new__
    dtarr = DatetimeArray._from_sequence_not_strict(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/arrays/datetimes.py", line 333, in _from_sequence_not_strict
    subarr, tz, inferred_freq = _sequence_to_dt64ns(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/arrays/datetimes.py", line 2057, in _sequence_to_dt64ns
    data, inferred_tz = objects_to_datetime64ns(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/arrays/datetimes.py", line 2177, in objects_to_datetime64ns
    result, tz_parsed = tslib.array_to_datetime(
KeyboardInterrupt
Trial 0 failed with value None.
A new study created in memory with name: no-name-3ec164f3-480e-46bc-b584-4b02502efffe
Trial 0 failed with parameters: {'learning_rate': 2.621749861096894e-05, 'n_steps': 9475, 'total_timesteps': 2084350, 'gamma': 0.970684750985766, 'gae_lambda': 0.9552967427658074, 'ent_coef': 0.09149939191734756, 'vf_coef': 0.10565541227092234, 'max_grad_norm': 0.19832539877960628, 'reward_scaling': 0.00018475440491302382, 'hmax': 47325, 'high_profit_bonus': 369, 'partial_sell_bonus': 407} because of the following error: KeyboardInterrupt().
Traceback (most recent call last):
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/hyperoptimizer/optunaoptimizer.py", line 87, in objective
    model.learn(total_timesteps=timesteps, callback=callbacks, tb_log_name="a2c_florian_any_name")
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/a2c/a2c.py", line 194, in learn
    return super().learn(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 259, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 178, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 197, in step
    return self.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 178, in step_wait
    obs, rewards, dones, infos = self.venv.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 58, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 164, in step
    self._handle_terminal_condition()
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 424, in _handle_terminal_condition
    df_rewards['date'] = self.date_memory[:-1]
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/frame.py", line 3950, in __setitem__
    self._set_item(key, value)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/frame.py", line 4143, in _set_item
    value = self._sanitize_column(value)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/frame.py", line 4871, in _sanitize_column
    return sanitize_array(value, self.index, copy=True, allow_2d=True)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/construction.py", line 602, in sanitize_array
    subarr = maybe_convert_platform(data)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/dtypes/cast.py", line 130, in maybe_convert_platform
    arr = construct_1d_object_array_from_listlike(values)
KeyboardInterrupt
Trial 0 failed with value None.
A new study created in memory with name: no-name-56ab924c-61b5-422d-81b7-39b0b002613d
Trial 0 finished with value: -inf and parameters: {'learning_rate': 2.4190471984858925e-05, 'n_steps': 5313, 'total_timesteps': 1877860, 'gamma': 0.9854751759289457, 'gae_lambda': 0.9068306686052015, 'ent_coef': 0.021601752204691543, 'vf_coef': 0.21635478110748005, 'max_grad_norm': 0.13723854704824814, 'reward_scaling': 0.00020482231968242947, 'hmax': 45201, 'high_profit_bonus': 342, 'partial_sell_bonus': 257}. Best is trial 0 with value: -inf.
Trial 1 finished with value: -inf and parameters: {'learning_rate': 1.3669669455187179e-05, 'n_steps': 1726, 'total_timesteps': 2527187, 'gamma': 0.9869487305855532, 'gae_lambda': 0.9767033502871326, 'ent_coef': 0.012785001508402168, 'vf_coef': 0.17819718031500711, 'max_grad_norm': 0.15332004962140794, 'reward_scaling': 0.00020873648578255654, 'hmax': 41315, 'high_profit_bonus': 331, 'partial_sell_bonus': 214}. Best is trial 0 with value: -inf.
Trial 2 finished with value: -inf and parameters: {'learning_rate': 8.536416225665886e-05, 'n_steps': 2562, 'total_timesteps': 1176353, 'gamma': 0.9218164996844986, 'gae_lambda': 0.9003669507052404, 'ent_coef': 0.070314603025563, 'vf_coef': 0.1376536179254503, 'max_grad_norm': 0.13592957199940692, 'reward_scaling': 0.0003917012647966694, 'hmax': 49710, 'high_profit_bonus': 321, 'partial_sell_bonus': 327}. Best is trial 0 with value: -inf.
Trial 3 finished with value: -inf and parameters: {'learning_rate': 1.1303583206693037e-05, 'n_steps': 7922, 'total_timesteps': 2384463, 'gamma': 0.9353170435053761, 'gae_lambda': 0.9743593443740919, 'ent_coef': 0.010238309159834874, 'vf_coef': 0.21611353095163682, 'max_grad_norm': 0.2865982780202533, 'reward_scaling': 9.855876601409314e-05, 'hmax': 47132, 'high_profit_bonus': 369, 'partial_sell_bonus': 295}. Best is trial 0 with value: -inf.
Trial 4 finished with value: -inf and parameters: {'learning_rate': 2.640637600539237e-05, 'n_steps': 9929, 'total_timesteps': 2908431, 'gamma': 0.9693120306328153, 'gae_lambda': 0.9598944503625289, 'ent_coef': 0.02110383809758057, 'vf_coef': 0.13928682824326977, 'max_grad_norm': 0.17348710043212398, 'reward_scaling': 0.000154106779419843, 'hmax': 45762, 'high_profit_bonus': 317, 'partial_sell_bonus': 230}. Best is trial 0 with value: -inf.
Trial 5 finished with value: -inf and parameters: {'learning_rate': 1.6381858435171313e-05, 'n_steps': 1290, 'total_timesteps': 1321824, 'gamma': 0.9038111347487616, 'gae_lambda': 0.9854875345550401, 'ent_coef': 0.025615289854745746, 'vf_coef': 0.22839529028760458, 'max_grad_norm': 0.14441545038839254, 'reward_scaling': 0.00044880720059503577, 'hmax': 47400, 'high_profit_bonus': 409, 'partial_sell_bonus': 332}. Best is trial 0 with value: -inf.
Trial 6 finished with value: -inf and parameters: {'learning_rate': 1.3103568028622177e-05, 'n_steps': 8775, 'total_timesteps': 1819364, 'gamma': 0.9718781705799494, 'gae_lambda': 0.9975253147987879, 'ent_coef': 0.014416867017066204, 'vf_coef': 0.1013563892593336, 'max_grad_norm': 0.2606248943757647, 'reward_scaling': 0.00026398092033569977, 'hmax': 43108, 'high_profit_bonus': 466, 'partial_sell_bonus': 293}. Best is trial 0 with value: -inf.
Trial 7 finished with value: -inf and parameters: {'learning_rate': 1.7694301526225893e-05, 'n_steps': 6008, 'total_timesteps': 1868955, 'gamma': 0.9682899070563865, 'gae_lambda': 0.9812059764044495, 'ent_coef': 0.03496463718932338, 'vf_coef': 0.14851960165571626, 'max_grad_norm': 0.20270549594429574, 'reward_scaling': 0.0009108833998452563, 'hmax': 43590, 'high_profit_bonus': 329, 'partial_sell_bonus': 295}. Best is trial 0 with value: -inf.
Trial 8 finished with value: -inf and parameters: {'learning_rate': 2.8428385921511524e-05, 'n_steps': 9385, 'total_timesteps': 1029868, 'gamma': 0.9146284594351712, 'gae_lambda': 0.9026056041417623, 'ent_coef': 0.035847875949358135, 'vf_coef': 0.2896023223475845, 'max_grad_norm': 0.1909962017796578, 'reward_scaling': 7.041923474706119e-05, 'hmax': 46102, 'high_profit_bonus': 371, 'partial_sell_bonus': 434}. Best is trial 0 with value: -inf.
Trial 9 finished with value: -inf and parameters: {'learning_rate': 1.8121734964429975e-05, 'n_steps': 9904, 'total_timesteps': 1466638, 'gamma': 0.9556053702236942, 'gae_lambda': 0.9353645109295452, 'ent_coef': 0.03356983945124705, 'vf_coef': 0.2581944972935205, 'max_grad_norm': 0.1543032439309346, 'reward_scaling': 0.0006104827647591728, 'hmax': 40756, 'high_profit_bonus': 351, 'partial_sell_bonus': 285}. Best is trial 0 with value: -inf.
Trial 0 is omitted in visualization because its objective value is inf or nan.
Trial 1 is omitted in visualization because its objective value is inf or nan.
Trial 2 is omitted in visualization because its objective value is inf or nan.
Trial 3 is omitted in visualization because its objective value is inf or nan.
Trial 4 is omitted in visualization because its objective value is inf or nan.
Trial 5 is omitted in visualization because its objective value is inf or nan.
Trial 6 is omitted in visualization because its objective value is inf or nan.
Trial 7 is omitted in visualization because its objective value is inf or nan.
Trial 8 is omitted in visualization because its objective value is inf or nan.
Trial 9 is omitted in visualization because its objective value is inf or nan.
Your study does not have any completed trials.
A new study created in memory with name: no-name-d4d68b4f-f074-4c4e-a9db-d618c7110105
Trial 0 failed with parameters: {'learning_rate': 4.8754860908024585e-05, 'n_steps': 5706, 'total_timesteps': 75671, 'gamma': 0.9242402296271499, 'gae_lambda': 0.9237057498639036, 'ent_coef': 0.04647150870174787, 'vf_coef': 0.20319621207932903, 'max_grad_norm': 0.17637918844489447, 'reward_scaling': 1.4925349162848006e-05, 'hmax': 46552, 'high_profit_bonus': 413, 'partial_sell_bonus': 210} because of the following error: KeyboardInterrupt().
Traceback (most recent call last):
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/hyperoptimizer/optunaoptimizer.py", line 87, in objective
    model.learn(total_timesteps=timesteps, callback=callbacks, tb_log_name="a2c_florian_any_name")
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/a2c/a2c.py", line 194, in learn
    return super().learn(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 259, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 178, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 197, in step
    return self.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 178, in step_wait
    obs, rewards, dones, infos = self.venv.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 58, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 164, in step
    self._handle_terminal_condition()
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 415, in _handle_terminal_condition
    df_total_value["date"] = self.date_memory
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/frame.py", line 3950, in __setitem__
    self._set_item(key, value)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/frame.py", line 4143, in _set_item
    value = self._sanitize_column(value)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/frame.py", line 4871, in _sanitize_column
    return sanitize_array(value, self.index, copy=True, allow_2d=True)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/construction.py", line 605, in sanitize_array
    subarr = maybe_infer_to_datetimelike(subarr)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/dtypes/cast.py", line 1204, in maybe_infer_to_datetimelike
    return lib.maybe_convert_objects(  # type: ignore[return-value]
  File "pandas/_libs/lib.pyx", line 2567, in pandas._libs.lib.maybe_convert_objects
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/indexes/datetimes.py", line 339, in __new__
    dtarr = DatetimeArray._from_sequence_not_strict(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/arrays/datetimes.py", line 333, in _from_sequence_not_strict
    subarr, tz, inferred_freq = _sequence_to_dt64ns(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/arrays/datetimes.py", line 2057, in _sequence_to_dt64ns
    data, inferred_tz = objects_to_datetime64ns(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/arrays/datetimes.py", line 2177, in objects_to_datetime64ns
    result, tz_parsed = tslib.array_to_datetime(
KeyboardInterrupt
Trial 0 failed with value None.
A new study created in memory with name: no-name-2a11ca01-b155-4caf-b23e-d941b9b5c29d
Trial 0 failed with parameters: {'learning_rate': 1.2514838082326984e-05, 'n_steps': 1060, 'total_timesteps': 57450, 'gamma': 0.9371973360525454, 'gae_lambda': 0.9064167616676043, 'ent_coef': 0.023177318658740235, 'vf_coef': 0.13714711561675444, 'max_grad_norm': 0.1542577332953147, 'reward_scaling': 8.971799210312636e-05, 'hmax': 46766, 'high_profit_bonus': 210, 'partial_sell_bonus': 419} because of the following error: KeyboardInterrupt().
Traceback (most recent call last):
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/hyperoptimizer/optunaoptimizer.py", line 87, in objective
    model.learn(total_timesteps=timesteps, callback=callbacks, tb_log_name="a2c_florian_any_name")
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/a2c/a2c.py", line 194, in learn
    return super().learn(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 259, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 178, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 197, in step
    return self.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 178, in step_wait
    obs, rewards, dones, infos = self.venv.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 58, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 184, in step
    self.date_memory.append(self._get_date())
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 320, in _get_date
    if len(self.df.tic.unique()) > 1:
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/series.py", line 2194, in unique
    return super().unique()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/base.py", line 1030, in unique
    result = algorithms.unique1d(values)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/algorithms.py", line 390, in unique
    return unique_with_mask(values)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/algorithms.py", line 429, in unique_with_mask
    uniques = table.unique(values)
KeyboardInterrupt
Trial 0 failed with value None.
A new study created in memory with name: no-name-1c86364b-1fab-40ce-aabb-53bd431d8c86
Trial 0 failed with parameters: {'learning_rate': 4.023318046038794e-05, 'n_steps': 7219, 'total_timesteps': 64729, 'gamma': 0.9832600253942226, 'gae_lambda': 0.930103459055925, 'ent_coef': 0.017740223637897484, 'vf_coef': 0.11775340329638714, 'max_grad_norm': 0.12432886768428503, 'reward_scaling': 1.3782501934577907e-05, 'hmax': 42659, 'high_profit_bonus': 306, 'partial_sell_bonus': 348} because of the following error: KeyboardInterrupt().
Traceback (most recent call last):
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/hyperoptimizer/optunaoptimizer.py", line 95, in objective
    mean_reward, _ = evaluate_policy(model, env_validate, n_eval_episodes=10)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/evaluation.py", line 94, in evaluate_policy
    new_observations, rewards, dones, infos = env.step(actions)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 197, in step
    return self.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 178, in step_wait
    obs, rewards, dones, infos = self.venv.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 58, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 164, in step
    self._handle_terminal_condition()
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 424, in _handle_terminal_condition
    df_rewards['date'] = self.date_memory[:-1]
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/frame.py", line 3950, in __setitem__
    self._set_item(key, value)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/frame.py", line 4143, in _set_item
    value = self._sanitize_column(value)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/frame.py", line 4871, in _sanitize_column
    return sanitize_array(value, self.index, copy=True, allow_2d=True)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/construction.py", line 605, in sanitize_array
    subarr = maybe_infer_to_datetimelike(subarr)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/dtypes/cast.py", line 1204, in maybe_infer_to_datetimelike
    return lib.maybe_convert_objects(  # type: ignore[return-value]
  File "pandas/_libs/lib.pyx", line 2564, in pandas._libs.lib.maybe_convert_objects
  File "<frozen importlib._bootstrap>", line 1053, in _handle_fromlist
KeyboardInterrupt
Trial 0 failed with value None.
A new study created in memory with name: no-name-724d8315-ffa2-4441-942c-2c7750475104
A new study created in memory with name: no-name-7d6ad81a-09fe-4628-872d-fd25825abaa7
Trial 0 finished with value: 72.73705510297656 and parameters: {'learning_rate': 3.6593671012218385e-05, 'n_steps': 3202, 'total_timesteps': 43932, 'gamma': 0.9205287743243765, 'gae_lambda': 0.9521659097545818, 'ent_coef': 0.01639321171844616, 'vf_coef': 0.1741854694727624, 'max_grad_norm': 0.2438779818183559, 'reward_scaling': 1.8007183782604134e-05, 'hmax': 46692, 'high_profit_bonus': 302, 'partial_sell_bonus': 206}. Best is trial 0 with value: 72.73705510297656.
Trial 1 finished with value: 63.02175547093517 and parameters: {'learning_rate': 1.1745611244882715e-05, 'n_steps': 3581, 'total_timesteps': 35969, 'gamma': 0.9549175707413667, 'gae_lambda': 0.9604271235550478, 'ent_coef': 0.0142037412896933, 'vf_coef': 0.27144197591155445, 'max_grad_norm': 0.27302930589057234, 'reward_scaling': 0.00044517444096033205, 'hmax': 42000, 'high_profit_bonus': 469, 'partial_sell_bonus': 351}. Best is trial 0 with value: 72.73705510297656.
Trial 2 finished with value: 70.67627888061193 and parameters: {'learning_rate': 5.358549272626731e-05, 'n_steps': 5468, 'total_timesteps': 38502, 'gamma': 0.9262049297434884, 'gae_lambda': 0.942210481912422, 'ent_coef': 0.06711046683494656, 'vf_coef': 0.2108567655093189, 'max_grad_norm': 0.3856370633891787, 'reward_scaling': 0.00013835076972426724, 'hmax': 41763, 'high_profit_bonus': 285, 'partial_sell_bonus': 248}. Best is trial 0 with value: 72.73705510297656.
Trial 3 failed with parameters: {'learning_rate': 8.71959614748617e-05, 'n_steps': 9667, 'total_timesteps': 49804, 'gamma': 0.9242253125010873, 'gae_lambda': 0.9249130257533019, 'ent_coef': 0.013135114768347798, 'vf_coef': 0.23097770903829407, 'max_grad_norm': 0.1300302997208232, 'reward_scaling': 1.7926597675366624e-05, 'hmax': 49784, 'high_profit_bonus': 423, 'partial_sell_bonus': 475} because of the following error: KeyboardInterrupt().
Traceback (most recent call last):
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/hyperoptimizer/optunaoptimizer.py", line 87, in objective
    model.learn(total_timesteps=timesteps, callback=callbacks, tb_log_name="a2c_florian_any_name")
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/a2c/a2c.py", line 194, in learn
    return super().learn(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 259, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 178, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 197, in step
    return self.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 178, in step_wait
    obs, rewards, dones, infos = self.venv.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 58, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 185, in step
    self.date_memory.append(self._get_date())
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/stock_trading.py", line 321, in _get_date
    if len(self.df.tic.unique()) > 1:
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/series.py", line 2194, in unique
    return super().unique()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/base.py", line 1030, in unique
    result = algorithms.unique1d(values)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/algorithms.py", line 390, in unique
    return unique_with_mask(values)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/algorithms.py", line 425, in unique_with_mask
    hashtable, values = _get_hashtable_algo(values)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/algorithms.py", line 264, in _get_hashtable_algo
    ndtype = _check_object_for_strings(values)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/algorithms.py", line 286, in _check_object_for_strings
    if lib.infer_dtype(values, skipna=False) in ["string"]:
  File "pandas/_libs/lib.pyx", line 1501, in pandas._libs.lib.infer_dtype
  File "pandas/_libs/lib.pyx", line 1363, in pandas._libs.lib._try_infer_map
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/numpy/core/_dtype.py", line 346, in _name_get
    def _name_get(dtype):
KeyboardInterrupt
Trial 3 failed with value None.
A new study created in memory with name: no-name-508f147d-ed48-4df9-a5fa-8771535a9b69
Trial 0 finished with value: 67.85632615356192 and parameters: {'learning_rate': 3.4097569920830305e-05, 'n_steps': 3574, 'total_timesteps': 15408, 'gamma': 0.9783555617767686, 'gae_lambda': 0.9725998302240753, 'ent_coef': 0.030372014430477576, 'vf_coef': 0.1933280177977153, 'max_grad_norm': 0.13793062906935805, 'reward_scaling': 2.9050685130989636e-05, 'hmax': 47931, 'high_profit_bonus': 354, 'partial_sell_bonus': 284}. Best is trial 0 with value: 67.85632615356192.
Trial 1 finished with value: 78.02394275537867 and parameters: {'learning_rate': 4.949641610254818e-05, 'n_steps': 7372, 'total_timesteps': 19761, 'gamma': 0.9067408197406008, 'gae_lambda': 0.9269281159394805, 'ent_coef': 0.014823362456354914, 'vf_coef': 0.11979827789951819, 'max_grad_norm': 0.32282479377013107, 'reward_scaling': 3.617677929091403e-05, 'hmax': 43050, 'high_profit_bonus': 336, 'partial_sell_bonus': 245}. Best is trial 1 with value: 78.02394275537867.
Trial 2 finished with value: 70.92514986771945 and parameters: {'learning_rate': 1.0742010904816057e-05, 'n_steps': 6886, 'total_timesteps': 12390, 'gamma': 0.9650745791100959, 'gae_lambda': 0.9683016376951596, 'ent_coef': 0.016529515679595604, 'vf_coef': 0.15339296745417516, 'max_grad_norm': 0.2750929333372003, 'reward_scaling': 0.00021481724331972243, 'hmax': 47957, 'high_profit_bonus': 337, 'partial_sell_bonus': 401}. Best is trial 1 with value: 78.02394275537867.
Trial 3 finished with value: 66.7364915941688 and parameters: {'learning_rate': 9.341197017048088e-05, 'n_steps': 5310, 'total_timesteps': 17348, 'gamma': 0.9859800821105502, 'gae_lambda': 0.90303472825759, 'ent_coef': 0.019458054872035488, 'vf_coef': 0.27441446507165507, 'max_grad_norm': 0.1875677804716173, 'reward_scaling': 1.0484789470270527e-05, 'hmax': 46803, 'high_profit_bonus': 375, 'partial_sell_bonus': 483}. Best is trial 1 with value: 78.02394275537867.
Trial 4 failed with parameters: {'learning_rate': 1.0366264636190467e-05, 'n_steps': 7961, 'total_timesteps': 18539, 'gamma': 0.9919582005778861, 'gae_lambda': 0.9423786229921434, 'ent_coef': 0.029550701177489837, 'vf_coef': 0.24879505760523005, 'max_grad_norm': 0.34230490965641086, 'reward_scaling': 4.541266248522972e-05, 'hmax': 49488, 'high_profit_bonus': 435, 'partial_sell_bonus': 209} because of the following error: KeyboardInterrupt().
Traceback (most recent call last):
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/hyperoptimizer/optunaoptimizer.py", line 87, in objective
    model.learn(total_timesteps=timesteps, callback=callbacks, tb_log_name="a2c_florian_any_name")
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/a2c/a2c.py", line 194, in learn
    return super().learn(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 259, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 207, in collect_rollouts
    rollout_buffer.add(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/buffers.py", line 450, in add
    if self.pos == self.buffer_size:
KeyboardInterrupt
Trial 4 failed with value None.
A new study created in memory with name: no-name-9a06c26a-0e94-4de6-95ef-6a5bb976c47b
Trial 0 failed with parameters: {'learning_rate': 6.601839198522086e-05, 'n_steps': 5613, 'total_timesteps': 2438304, 'gamma': 0.919728964454328, 'gae_lambda': 0.937537643424791, 'ent_coef': 0.027248763513415545, 'vf_coef': 0.27720210973668186, 'max_grad_norm': 0.27736803062240817, 'reward_scaling': 0.0008213305075735804, 'hmax': 84681, 'sharpe_ratio_weight': 0.2648660418336906, 'loss_penalty_weight': 0.4953377942188184} because of the following error: KeyboardInterrupt().
Traceback (most recent call last):
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/hyperoptimizer/optunaoptimizer.py", line 362, in objective
    model.learn(total_timesteps=timesteps, callback=callbacks, tb_log_name="a2c_florian_any_name")
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/a2c/a2c.py", line 194, in learn
    return super().learn(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 259, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 178, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 197, in step
    return self.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 178, in step_wait
    obs, rewards, dones, infos = self.venv.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 58, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/portfolio_bbg.py", line 235, in step
    self.state = self._update_state()
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/portfolio_bbg.py", line 333, in _update_state
    if len(self.df.tic.unique()) >1:
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/series.py", line 2194, in unique
    return super().unique()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/base.py", line 1030, in unique
    result = algorithms.unique1d(values)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/algorithms.py", line 390, in unique
    return unique_with_mask(values)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/algorithms.py", line 429, in unique_with_mask
    uniques = table.unique(values)
KeyboardInterrupt
Trial 0 failed with value None.
A new study created in memory with name: no-name-0c2ea0d7-a8d9-4729-a5e7-82740114e8b4
Trial 0 failed with parameters: {'learning_rate': 5.243075122733361e-05, 'n_steps': 5752, 'total_timesteps': 884468, 'gamma': 0.9262927279446139, 'gae_lambda': 0.9562272299820974, 'ent_coef': 0.01492476473766294, 'vf_coef': 0.1494033880022209, 'max_grad_norm': 0.2649075830040124, 'reward_scaling': 0.0001378213999292392, 'hmax': 74674, 'sharpe_ratio_weight': 0.44519884698264367, 'loss_penalty_weight': 0.5289242975258798} because of the following error: KeyboardInterrupt().
Traceback (most recent call last):
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/hyperoptimizer/optunaoptimizer.py", line 362, in objective
    model.learn(total_timesteps=timesteps, callback=callbacks, tb_log_name="a2c_florian_any_name")
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/a2c/a2c.py", line 194, in learn
    return super().learn(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 259, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 178, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 197, in step
    return self.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 178, in step_wait
    obs, rewards, dones, infos = self.venv.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 58, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/portfolio_bbg.py", line 235, in step
    self.state = self._update_state()
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/portfolio_bbg.py", line 333, in _update_state
    if len(self.df.tic.unique()) >1:
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/series.py", line 2194, in unique
    return super().unique()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/base.py", line 1030, in unique
    result = algorithms.unique1d(values)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/algorithms.py", line 390, in unique
    return unique_with_mask(values)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/algorithms.py", line 429, in unique_with_mask
    uniques = table.unique(values)
KeyboardInterrupt
Trial 0 failed with value None.
A new study created in memory with name: no-name-39081b1e-c2ce-4dd4-9bdf-4d08f945f42d
Trial 0 failed with parameters: {'learning_rate': 9.589310466306916e-05, 'n_steps': 2330, 'total_timesteps': 1418243, 'gamma': 0.962356963177991, 'gae_lambda': 0.9242685956736947, 'ent_coef': 0.04315891990460533, 'vf_coef': 0.11506183984357406, 'max_grad_norm': 0.13489858156673654, 'reward_scaling': 4.694592466645883e-05, 'hmax': 64214, 'sharpe_ratio_weight': 0.46109445898418844, 'loss_penalty_weight': 0.11299296220989545} because of the following error: The value None could not be cast to float..
Trial 0 failed with value None.
Trial 1 failed with parameters: {'learning_rate': 1.7636876038377004e-05, 'n_steps': 8242, 'total_timesteps': 2440903, 'gamma': 0.938365977927349, 'gae_lambda': 0.9700934561989978, 'ent_coef': 0.015573095498111814, 'vf_coef': 0.11911380098933559, 'max_grad_norm': 0.14868485267265227, 'reward_scaling': 1.044518994635261e-05, 'hmax': 58282, 'sharpe_ratio_weight': 0.7763391457273314, 'loss_penalty_weight': 0.21001854244162074} because of the following error: The value None could not be cast to float..
Trial 1 failed with value None.
Trial 2 failed with parameters: {'learning_rate': 2.2089285014401306e-05, 'n_steps': 4431, 'total_timesteps': 828239, 'gamma': 0.9490372811438956, 'gae_lambda': 0.9456705561852049, 'ent_coef': 0.010523950417508218, 'vf_coef': 0.1700631097168351, 'max_grad_norm': 0.2266859920250476, 'reward_scaling': 5.582749390978326e-05, 'hmax': 40648, 'sharpe_ratio_weight': 0.20931957519337566, 'loss_penalty_weight': 0.1754914683911134} because of the following error: The value None could not be cast to float..
Trial 2 failed with value None.
Trial 3 failed with parameters: {'learning_rate': 9.179088588911836e-05, 'n_steps': 5706, 'total_timesteps': 2287390, 'gamma': 0.9054388727748731, 'gae_lambda': 0.9546880175191431, 'ent_coef': 0.05800777489380867, 'vf_coef': 0.17887362493553186, 'max_grad_norm': 0.15724243525834578, 'reward_scaling': 1.472009456564029e-05, 'hmax': 47960, 'sharpe_ratio_weight': 0.3987349173450928, 'loss_penalty_weight': 0.16549933864929603} because of the following error: The value None could not be cast to float..
Trial 3 failed with value None.
Trial 4 failed with parameters: {'learning_rate': 4.2402441942509245e-05, 'n_steps': 2477, 'total_timesteps': 2349972, 'gamma': 0.9835916318146368, 'gae_lambda': 0.9853990328456914, 'ent_coef': 0.0404902595572735, 'vf_coef': 0.23211268377830913, 'max_grad_norm': 0.14345797922295536, 'reward_scaling': 0.00014727985181895798, 'hmax': 61393, 'sharpe_ratio_weight': 0.47648379375138933, 'loss_penalty_weight': 0.3754312179762635} because of the following error: The value None could not be cast to float..
Trial 4 failed with value None.
Trial 5 failed with parameters: {'learning_rate': 1.494202376481711e-05, 'n_steps': 2341, 'total_timesteps': 1838595, 'gamma': 0.9810262814939757, 'gae_lambda': 0.9145565699913337, 'ent_coef': 0.018165227705327715, 'vf_coef': 0.1132283325004548, 'max_grad_norm': 0.3823560947765696, 'reward_scaling': 0.00013296933121265722, 'hmax': 62370, 'sharpe_ratio_weight': 0.4838989465901677, 'loss_penalty_weight': 0.478113862472347} because of the following error: The value None could not be cast to float..
Trial 5 failed with value None.
Trial 6 failed with parameters: {'learning_rate': 7.401127846084644e-05, 'n_steps': 8308, 'total_timesteps': 854642, 'gamma': 0.9633664807470091, 'gae_lambda': 0.9487709125142689, 'ent_coef': 0.010830114765663527, 'vf_coef': 0.25342318414606957, 'max_grad_norm': 0.3302259472841444, 'reward_scaling': 1.7731166293414724e-05, 'hmax': 49068, 'sharpe_ratio_weight': 0.27849352932036603, 'loss_penalty_weight': 0.5252113713315519} because of the following error: The value None could not be cast to float..
Trial 6 failed with value None.
Trial 7 failed with parameters: {'learning_rate': 5.436172494943763e-05, 'n_steps': 9697, 'total_timesteps': 1537702, 'gamma': 0.924944975625324, 'gae_lambda': 0.9523508168470236, 'ent_coef': 0.061364649299827025, 'vf_coef': 0.13531453547628794, 'max_grad_norm': 0.10027934369043358, 'reward_scaling': 2.297718276748139e-05, 'hmax': 65970, 'sharpe_ratio_weight': 0.27513738891617906, 'loss_penalty_weight': 0.1832778921033717} because of the following error: The value None could not be cast to float..
Trial 7 failed with value None.
Trial 8 failed with parameters: {'learning_rate': 1.2063267110404167e-05, 'n_steps': 3915, 'total_timesteps': 2839046, 'gamma': 0.9011405786408614, 'gae_lambda': 0.960785830274475, 'ent_coef': 0.08128354802976266, 'vf_coef': 0.15502960209091948, 'max_grad_norm': 0.20431446918241983, 'reward_scaling': 0.0005032447973255337, 'hmax': 98768, 'sharpe_ratio_weight': 0.7949171764046276, 'loss_penalty_weight': 0.5827365067853137} because of the following error: The value None could not be cast to float..
Trial 8 failed with value None.
Trial 9 failed with parameters: {'learning_rate': 5.356454285059037e-05, 'n_steps': 9997, 'total_timesteps': 1056113, 'gamma': 0.9204555039226399, 'gae_lambda': 0.9060497367559623, 'ent_coef': 0.025841887159960684, 'vf_coef': 0.12950943678217355, 'max_grad_norm': 0.1813304065235366, 'reward_scaling': 6.426640697861658e-05, 'hmax': 62555, 'sharpe_ratio_weight': 0.6098130003302712, 'loss_penalty_weight': 0.17235247753566985} because of the following error: The value None could not be cast to float..
Trial 9 failed with value None.
Trial 10 failed with parameters: {'learning_rate': 1.9570178316707524e-05, 'n_steps': 2194, 'total_timesteps': 2875306, 'gamma': 0.9983821028377742, 'gae_lambda': 0.9628384991966878, 'ent_coef': 0.058979597261745634, 'vf_coef': 0.16908655926568342, 'max_grad_norm': 0.12055567007687751, 'reward_scaling': 2.174163348006104e-05, 'hmax': 58554, 'sharpe_ratio_weight': 0.5806657337803882, 'loss_penalty_weight': 0.13127983980846245} because of the following error: The value None could not be cast to float..
Trial 10 failed with value None.
Trial 11 failed with parameters: {'learning_rate': 5.762040705258147e-05, 'n_steps': 7802, 'total_timesteps': 2599702, 'gamma': 0.9965657728972654, 'gae_lambda': 0.9137839153153436, 'ent_coef': 0.011901218725760826, 'vf_coef': 0.15819426339103893, 'max_grad_norm': 0.34789521762564957, 'reward_scaling': 1.5261285207806592e-05, 'hmax': 72830, 'sharpe_ratio_weight': 0.7935429378714074, 'loss_penalty_weight': 0.13720798208380525} because of the following error: The value None could not be cast to float..
Trial 11 failed with value None.
Trial 12 failed with parameters: {'learning_rate': 8.165333485142874e-05, 'n_steps': 1502, 'total_timesteps': 1388779, 'gamma': 0.9441675138378812, 'gae_lambda': 0.9324087258495539, 'ent_coef': 0.013504121859290109, 'vf_coef': 0.19122941976200056, 'max_grad_norm': 0.17754988456301227, 'reward_scaling': 0.00039942417477926886, 'hmax': 75758, 'sharpe_ratio_weight': 0.3270598946337596, 'loss_penalty_weight': 0.2767088192191909} because of the following error: The value None could not be cast to float..
Trial 12 failed with value None.
Trial 13 failed with parameters: {'learning_rate': 5.922791755605682e-05, 'n_steps': 9245, 'total_timesteps': 2310122, 'gamma': 0.9113863021548276, 'gae_lambda': 0.981591628456157, 'ent_coef': 0.03583909820609862, 'vf_coef': 0.17963190920269326, 'max_grad_norm': 0.10271743824295017, 'reward_scaling': 0.00016477026565192655, 'hmax': 46361, 'sharpe_ratio_weight': 0.54067004397875, 'loss_penalty_weight': 0.30294111467056} because of the following error: The value None could not be cast to float..
Trial 13 failed with value None.
Trial 14 failed with parameters: {'learning_rate': 1.4237353238953663e-05, 'n_steps': 5310, 'total_timesteps': 1716517, 'gamma': 0.9771001281149921, 'gae_lambda': 0.921837619711517, 'ent_coef': 0.010041506694327391, 'vf_coef': 0.15085601581065014, 'max_grad_norm': 0.11655784537677553, 'reward_scaling': 0.0005737249776326578, 'hmax': 87077, 'sharpe_ratio_weight': 0.8997118879702849, 'loss_penalty_weight': 0.565810277913559} because of the following error: The value None could not be cast to float..
Trial 14 failed with value None.
Trial 15 failed with parameters: {'learning_rate': 6.305156005336938e-05, 'n_steps': 2193, 'total_timesteps': 2752571, 'gamma': 0.9943514501380549, 'gae_lambda': 0.9592854839141883, 'ent_coef': 0.08310536192121426, 'vf_coef': 0.13191037738040384, 'max_grad_norm': 0.33536830681589624, 'reward_scaling': 0.00010586794203670023, 'hmax': 66936, 'sharpe_ratio_weight': 0.3440354823145063, 'loss_penalty_weight': 0.1022322204799323} because of the following error: The value None could not be cast to float..
Trial 15 failed with value None.
Trial 16 failed with parameters: {'learning_rate': 2.903052462194726e-05, 'n_steps': 9778, 'total_timesteps': 1289129, 'gamma': 0.9018073196632425, 'gae_lambda': 0.9105459747672663, 'ent_coef': 0.0497426766313211, 'vf_coef': 0.2210679293322581, 'max_grad_norm': 0.18378510195209233, 'reward_scaling': 1.9440954478431148e-05, 'hmax': 90474, 'sharpe_ratio_weight': 0.4195374731551992, 'loss_penalty_weight': 0.37892810311053937} because of the following error: The value None could not be cast to float..
Trial 16 failed with value None.
Trial 17 failed with parameters: {'learning_rate': 2.609388988137579e-05, 'n_steps': 5486, 'total_timesteps': 999234, 'gamma': 0.9288805218593054, 'gae_lambda': 0.9715024613419688, 'ent_coef': 0.030382554440430903, 'vf_coef': 0.10603911872081764, 'max_grad_norm': 0.19280243288257976, 'reward_scaling': 0.0005355211846000644, 'hmax': 81653, 'sharpe_ratio_weight': 0.4510557469723493, 'loss_penalty_weight': 0.5787917550194543} because of the following error: The value None could not be cast to float..
Trial 17 failed with value None.
Trial 18 failed with parameters: {'learning_rate': 1.881792599283698e-05, 'n_steps': 1234, 'total_timesteps': 1672444, 'gamma': 0.9319833283275623, 'gae_lambda': 0.9471032159884227, 'ent_coef': 0.03149807023366197, 'vf_coef': 0.1175958819357549, 'max_grad_norm': 0.12075825423372534, 'reward_scaling': 2.8130675444095498e-05, 'hmax': 77984, 'sharpe_ratio_weight': 0.8111821213594634, 'loss_penalty_weight': 0.4666533048996625} because of the following error: The value None could not be cast to float..
Trial 18 failed with value None.
Trial 19 failed with parameters: {'learning_rate': 4.870372105242761e-05, 'n_steps': 5743, 'total_timesteps': 1599099, 'gamma': 0.9282451261626143, 'gae_lambda': 0.9130916007617336, 'ent_coef': 0.01894279603495527, 'vf_coef': 0.18735926882572748, 'max_grad_norm': 0.2268514883554195, 'reward_scaling': 1.4862238939175313e-05, 'hmax': 97131, 'sharpe_ratio_weight': 0.8769207742064374, 'loss_penalty_weight': 0.14593524961869409} because of the following error: The value None could not be cast to float..
Trial 19 failed with value None.
Trial 20 failed with parameters: {'learning_rate': 1.284901101597863e-05, 'n_steps': 1593, 'total_timesteps': 954893, 'gamma': 0.9852382027837868, 'gae_lambda': 0.912682171028583, 'ent_coef': 0.05735750304641964, 'vf_coef': 0.22620231155717294, 'max_grad_norm': 0.3578098841171157, 'reward_scaling': 1.4400305982902855e-05, 'hmax': 51480, 'sharpe_ratio_weight': 0.563110292686272, 'loss_penalty_weight': 0.3531319637814223} because of the following error: The value None could not be cast to float..
Trial 20 failed with value None.
Trial 21 failed with parameters: {'learning_rate': 2.6103879497591062e-05, 'n_steps': 4179, 'total_timesteps': 2370563, 'gamma': 0.9843458238054307, 'gae_lambda': 0.904815981655962, 'ent_coef': 0.016516616985214908, 'vf_coef': 0.28685104777707954, 'max_grad_norm': 0.3252464177670838, 'reward_scaling': 2.556533982832115e-05, 'hmax': 51571, 'sharpe_ratio_weight': 0.4560337362992578, 'loss_penalty_weight': 0.13216287330283422} because of the following error: The value None could not be cast to float..
Trial 21 failed with value None.
Trial 22 failed with parameters: {'learning_rate': 1.1543643201564712e-05, 'n_steps': 6312, 'total_timesteps': 1175723, 'gamma': 0.922447455202455, 'gae_lambda': 0.9778392746071475, 'ent_coef': 0.02181009176172588, 'vf_coef': 0.15788890899225988, 'max_grad_norm': 0.2052928338677983, 'reward_scaling': 1.1398217254764002e-05, 'hmax': 83283, 'sharpe_ratio_weight': 0.7037163543570824, 'loss_penalty_weight': 0.40722635613871616} because of the following error: The value None could not be cast to float..
Trial 22 failed with value None.
Trial 23 failed with parameters: {'learning_rate': 2.195384332875397e-05, 'n_steps': 3183, 'total_timesteps': 2101109, 'gamma': 0.9817587303303192, 'gae_lambda': 0.9445037338577342, 'ent_coef': 0.01884368124160658, 'vf_coef': 0.113903264610667, 'max_grad_norm': 0.2436732262921207, 'reward_scaling': 1.0778929475685013e-05, 'hmax': 99720, 'sharpe_ratio_weight': 0.38206611968222265, 'loss_penalty_weight': 0.15059800545438085} because of the following error: The value None could not be cast to float..
Trial 23 failed with value None.
Trial 24 failed with parameters: {'learning_rate': 7.172713398505154e-05, 'n_steps': 2560, 'total_timesteps': 1597076, 'gamma': 0.9105852387157628, 'gae_lambda': 0.9794147481785155, 'ent_coef': 0.018652756881084163, 'vf_coef': 0.13293144358110462, 'max_grad_norm': 0.29910789798514303, 'reward_scaling': 0.00021314414206094313, 'hmax': 44951, 'sharpe_ratio_weight': 0.48456508387790187, 'loss_penalty_weight': 0.31142414819122827} because of the following error: The value None could not be cast to float..
Trial 24 failed with value None.
Trial 25 failed with parameters: {'learning_rate': 9.13177879257498e-05, 'n_steps': 5868, 'total_timesteps': 1589938, 'gamma': 0.9188152255526059, 'gae_lambda': 0.9144848900028502, 'ent_coef': 0.08513531672065423, 'vf_coef': 0.12993547196278302, 'max_grad_norm': 0.126500545103108, 'reward_scaling': 0.0004233417500716676, 'hmax': 92786, 'sharpe_ratio_weight': 0.3923515229817147, 'loss_penalty_weight': 0.25262706114906225} because of the following error: The value None could not be cast to float..
Trial 25 failed with value None.
Trial 26 failed with parameters: {'learning_rate': 1.4158045179406076e-05, 'n_steps': 6751, 'total_timesteps': 1898035, 'gamma': 0.9862162429838578, 'gae_lambda': 0.9313784190998124, 'ent_coef': 0.04398420506984495, 'vf_coef': 0.11282194625806412, 'max_grad_norm': 0.32630424401957037, 'reward_scaling': 0.00030031436767100414, 'hmax': 42333, 'sharpe_ratio_weight': 0.5862549651242378, 'loss_penalty_weight': 0.3618573501506806} because of the following error: The value None could not be cast to float..
Trial 26 failed with value None.
Trial 27 failed with parameters: {'learning_rate': 1.3515817933271101e-05, 'n_steps': 6107, 'total_timesteps': 1381762, 'gamma': 0.9777466894133471, 'gae_lambda': 0.9867229603397871, 'ent_coef': 0.011356189262589281, 'vf_coef': 0.13840619533018023, 'max_grad_norm': 0.37922082613128577, 'reward_scaling': 0.0008369703407121313, 'hmax': 67471, 'sharpe_ratio_weight': 0.6432244800689413, 'loss_penalty_weight': 0.31040011040068577} because of the following error: The value None could not be cast to float..
Trial 27 failed with value None.
Trial 28 failed with parameters: {'learning_rate': 2.640209672149357e-05, 'n_steps': 6173, 'total_timesteps': 2501369, 'gamma': 0.9315447959316209, 'gae_lambda': 0.956420123217491, 'ent_coef': 0.03219368404547157, 'vf_coef': 0.12700012801840904, 'max_grad_norm': 0.1250634352808206, 'reward_scaling': 6.677235730939984e-05, 'hmax': 63776, 'sharpe_ratio_weight': 0.2545569124143987, 'loss_penalty_weight': 0.18527460179267163} because of the following error: The value None could not be cast to float..
Trial 28 failed with value None.
Trial 29 failed with parameters: {'learning_rate': 1.2170012563447548e-05, 'n_steps': 6015, 'total_timesteps': 2718880, 'gamma': 0.9617111657128525, 'gae_lambda': 0.9314942856031205, 'ent_coef': 0.03527630668894847, 'vf_coef': 0.10085034413369233, 'max_grad_norm': 0.2412777456471719, 'reward_scaling': 0.0008035123768060393, 'hmax': 97883, 'sharpe_ratio_weight': 0.6636056518947913, 'loss_penalty_weight': 0.21761914921038697} because of the following error: The value None could not be cast to float..
Trial 29 failed with value None.
A new study created in memory with name: no-name-a9b98424-0fc9-4dab-960e-e2f151242965
Trial 0 failed with parameters: {'learning_rate': 9.73876593142547e-05, 'n_steps': 8063, 'total_timesteps': 914144, 'gamma': 0.9443384782649065, 'gae_lambda': 0.9476774018625819, 'ent_coef': 0.018107707202558818, 'vf_coef': 0.21647591377526954, 'max_grad_norm': 0.35137919521444877, 'reward_scaling': 0.00043301718577043544, 'hmax': 47199, 'sharpe_ratio_weight': 0.5011483093961907, 'loss_penalty_weight': 0.5164998462443595} because of the following error: The value None could not be cast to float..
Trial 0 failed with value None.
Trial 1 failed with parameters: {'learning_rate': 7.710293009669497e-05, 'n_steps': 5812, 'total_timesteps': 2626435, 'gamma': 0.9253255633461639, 'gae_lambda': 0.9383223642207585, 'ent_coef': 0.02006488511553183, 'vf_coef': 0.11953114115360627, 'max_grad_norm': 0.18078738707485206, 'reward_scaling': 0.00023350343743049754, 'hmax': 67518, 'sharpe_ratio_weight': 0.2196449187199475, 'loss_penalty_weight': 0.3410483495934692} because of the following error: The value None could not be cast to float..
Trial 1 failed with value None.
Trial 2 failed with parameters: {'learning_rate': 1.6613836689965106e-05, 'n_steps': 8004, 'total_timesteps': 965529, 'gamma': 0.9690208779690829, 'gae_lambda': 0.9819320194077822, 'ent_coef': 0.0938170250274149, 'vf_coef': 0.10138638079092548, 'max_grad_norm': 0.28919739220927654, 'reward_scaling': 6.57514191407029e-05, 'hmax': 65940, 'sharpe_ratio_weight': 0.29171699081991037, 'loss_penalty_weight': 0.10325309373039356} because of the following error: The value None could not be cast to float..
Trial 2 failed with value None.
Trial 3 failed with parameters: {'learning_rate': 1.0100233367403989e-05, 'n_steps': 3747, 'total_timesteps': 886469, 'gamma': 0.9305961159809, 'gae_lambda': 0.9815313560837878, 'ent_coef': 0.0248564600813501, 'vf_coef': 0.10536900934081678, 'max_grad_norm': 0.14270571653837766, 'reward_scaling': 0.00026614855623831703, 'hmax': 43771, 'sharpe_ratio_weight': 0.22886929377123527, 'loss_penalty_weight': 0.3743483199266349} because of the following error: The value None could not be cast to float..
Trial 3 failed with value None.
Trial 4 failed with parameters: {'learning_rate': 1.6318174481358234e-05, 'n_steps': 1201, 'total_timesteps': 2131478, 'gamma': 0.9212246973385493, 'gae_lambda': 0.939308198011692, 'ent_coef': 0.029637231824377573, 'vf_coef': 0.10183777835641217, 'max_grad_norm': 0.17498647100899015, 'reward_scaling': 6.168190926021676e-05, 'hmax': 68645, 'sharpe_ratio_weight': 0.2255098056943788, 'loss_penalty_weight': 0.32950262216804654} because of the following error: The value None could not be cast to float..
Trial 4 failed with value None.
Trial 5 failed with parameters: {'learning_rate': 3.2163614725468415e-05, 'n_steps': 6074, 'total_timesteps': 1294767, 'gamma': 0.922248884335722, 'gae_lambda': 0.9653963022050236, 'ent_coef': 0.025691613485028603, 'vf_coef': 0.16473315812056807, 'max_grad_norm': 0.16524719452355388, 'reward_scaling': 0.00043492993261838044, 'hmax': 60835, 'sharpe_ratio_weight': 0.300284368059502, 'loss_penalty_weight': 0.11895605502206172} because of the following error: The value None could not be cast to float..
Trial 5 failed with value None.
Trial 6 failed with parameters: {'learning_rate': 1.2647696018528248e-05, 'n_steps': 9483, 'total_timesteps': 1340446, 'gamma': 0.9303735541867175, 'gae_lambda': 0.910534837547213, 'ent_coef': 0.015257416794924018, 'vf_coef': 0.13168463105094713, 'max_grad_norm': 0.14925332236606967, 'reward_scaling': 0.00018826465002601893, 'hmax': 45447, 'sharpe_ratio_weight': 0.49838841361227404, 'loss_penalty_weight': 0.12416885876735911} because of the following error: The value None could not be cast to float..
Trial 6 failed with value None.
Trial 7 failed with parameters: {'learning_rate': 2.2689904159853795e-05, 'n_steps': 3470, 'total_timesteps': 1763705, 'gamma': 0.935704055932506, 'gae_lambda': 0.9252679480828964, 'ent_coef': 0.01346515997725952, 'vf_coef': 0.2880615409875132, 'max_grad_norm': 0.19722619932261035, 'reward_scaling': 0.0002044012971244768, 'hmax': 44458, 'sharpe_ratio_weight': 0.262764434160069, 'loss_penalty_weight': 0.29959538240940425} because of the following error: The value None could not be cast to float..
Trial 7 failed with value None.
Trial 8 failed with parameters: {'learning_rate': 4.5431509579671305e-05, 'n_steps': 9981, 'total_timesteps': 2713050, 'gamma': 0.9628334532144129, 'gae_lambda': 0.9915913499588768, 'ent_coef': 0.012579287926577467, 'vf_coef': 0.20745418851638425, 'max_grad_norm': 0.2646082616374035, 'reward_scaling': 0.0008442535039298567, 'hmax': 52326, 'sharpe_ratio_weight': 0.6352815692297804, 'loss_penalty_weight': 0.33069200335121635} because of the following error: The value None could not be cast to float..
Trial 8 failed with value None.
Trial 9 failed with parameters: {'learning_rate': 1.7549380219843526e-05, 'n_steps': 7549, 'total_timesteps': 1502492, 'gamma': 0.9684425232538041, 'gae_lambda': 0.9437063321924224, 'ent_coef': 0.08409055651659604, 'vf_coef': 0.15374766115141122, 'max_grad_norm': 0.2676467973407749, 'reward_scaling': 0.00014385223403387952, 'hmax': 94819, 'sharpe_ratio_weight': 0.7751877520669624, 'loss_penalty_weight': 0.3372117103182791} because of the following error: The value None could not be cast to float..
Trial 9 failed with value None.
Trial 10 failed with parameters: {'learning_rate': 6.338687758741602e-05, 'n_steps': 2514, 'total_timesteps': 887117, 'gamma': 0.9625460730836674, 'gae_lambda': 0.9410248038679311, 'ent_coef': 0.0697786500574643, 'vf_coef': 0.15892494851227476, 'max_grad_norm': 0.25438119037869505, 'reward_scaling': 0.0002897442590790381, 'hmax': 77474, 'sharpe_ratio_weight': 0.5206868833895735, 'loss_penalty_weight': 0.3632185546117907} because of the following error: The value None could not be cast to float..
Trial 10 failed with value None.
Trial 11 failed with parameters: {'learning_rate': 4.041995828867222e-05, 'n_steps': 9324, 'total_timesteps': 824213, 'gamma': 0.9098352300287088, 'gae_lambda': 0.945948742035128, 'ent_coef': 0.0794514125202293, 'vf_coef': 0.25510086689368366, 'max_grad_norm': 0.1716734531615259, 'reward_scaling': 5.141499327636256e-05, 'hmax': 41763, 'sharpe_ratio_weight': 0.5119620567481948, 'loss_penalty_weight': 0.2580794661584835} because of the following error: The value None could not be cast to float..
Trial 11 failed with value None.
Trial 12 failed with parameters: {'learning_rate': 4.8171845220557766e-05, 'n_steps': 5294, 'total_timesteps': 2775560, 'gamma': 0.9976147783437688, 'gae_lambda': 0.9719152759118094, 'ent_coef': 0.03993677369913294, 'vf_coef': 0.18027281688920715, 'max_grad_norm': 0.13363307749728837, 'reward_scaling': 0.0003788852539888561, 'hmax': 42762, 'sharpe_ratio_weight': 0.4750666506486215, 'loss_penalty_weight': 0.28931692567226475} because of the following error: The value None could not be cast to float..
Trial 12 failed with value None.
Trial 13 failed with parameters: {'learning_rate': 1.1828732712274452e-05, 'n_steps': 5587, 'total_timesteps': 2914094, 'gamma': 0.943126382139414, 'gae_lambda': 0.9186874521925862, 'ent_coef': 0.051597973950157285, 'vf_coef': 0.22711263004693732, 'max_grad_norm': 0.28494506865660413, 'reward_scaling': 0.000114756800324289, 'hmax': 75436, 'sharpe_ratio_weight': 0.3083389318033399, 'loss_penalty_weight': 0.4039902928731413} because of the following error: The value None could not be cast to float..
Trial 13 failed with value None.
Trial 14 failed with parameters: {'learning_rate': 1.3276084776408547e-05, 'n_steps': 4293, 'total_timesteps': 2082208, 'gamma': 0.9012117204675414, 'gae_lambda': 0.9189951921572854, 'ent_coef': 0.02081724594384654, 'vf_coef': 0.1880910441587594, 'max_grad_norm': 0.2636596325903727, 'reward_scaling': 2.6084140602462852e-05, 'hmax': 85930, 'sharpe_ratio_weight': 0.27076301943817493, 'loss_penalty_weight': 0.12121605329346369} because of the following error: The value None could not be cast to float..
Trial 14 failed with value None.
Trial 15 failed with parameters: {'learning_rate': 7.497967895256403e-05, 'n_steps': 8885, 'total_timesteps': 1048583, 'gamma': 0.9974156390292411, 'gae_lambda': 0.9138590609528418, 'ent_coef': 0.030795191475907095, 'vf_coef': 0.1878170890430971, 'max_grad_norm': 0.373843278539431, 'reward_scaling': 1.3345669891917357e-05, 'hmax': 59860, 'sharpe_ratio_weight': 0.304712763257693, 'loss_penalty_weight': 0.34408851238411076} because of the following error: The value None could not be cast to float..
Trial 15 failed with value None.
Trial 16 failed with parameters: {'learning_rate': 9.5773254388937e-05, 'n_steps': 4096, 'total_timesteps': 2245478, 'gamma': 0.9837368555279488, 'gae_lambda': 0.9351028661947814, 'ent_coef': 0.012390059768445753, 'vf_coef': 0.24882309935185631, 'max_grad_norm': 0.2410795622555369, 'reward_scaling': 0.000615412949053843, 'hmax': 59669, 'sharpe_ratio_weight': 0.36043786065130806, 'loss_penalty_weight': 0.14367629379365798} because of the following error: The value None could not be cast to float..
Trial 16 failed with value None.
Trial 17 failed with parameters: {'learning_rate': 3.279218407196778e-05, 'n_steps': 6000, 'total_timesteps': 2871102, 'gamma': 0.9233344357120604, 'gae_lambda': 0.9577398770222976, 'ent_coef': 0.08315042742806818, 'vf_coef': 0.2846176518201423, 'max_grad_norm': 0.20960587292010596, 'reward_scaling': 1.4619855337557916e-05, 'hmax': 52295, 'sharpe_ratio_weight': 0.21875308197841603, 'loss_penalty_weight': 0.2297046479684539} because of the following error: The value None could not be cast to float..
Trial 17 failed with value None.
Trial 18 failed with parameters: {'learning_rate': 8.122686265808917e-05, 'n_steps': 6638, 'total_timesteps': 1816334, 'gamma': 0.9728635548460965, 'gae_lambda': 0.9008670126912256, 'ent_coef': 0.026394071734699095, 'vf_coef': 0.2023198720987773, 'max_grad_norm': 0.2357414778117521, 'reward_scaling': 0.00014251481533917288, 'hmax': 72441, 'sharpe_ratio_weight': 0.4668309416343804, 'loss_penalty_weight': 0.35687858927305} because of the following error: The value None could not be cast to float..
Trial 18 failed with value None.
Trial 19 failed with parameters: {'learning_rate': 1.9431917991475784e-05, 'n_steps': 9675, 'total_timesteps': 1430003, 'gamma': 0.9297815108553035, 'gae_lambda': 0.9045576218823111, 'ent_coef': 0.0661297393097836, 'vf_coef': 0.18775235872490387, 'max_grad_norm': 0.2274382207803168, 'reward_scaling': 1.753698499898788e-05, 'hmax': 46111, 'sharpe_ratio_weight': 0.41891563421716255, 'loss_penalty_weight': 0.1396120743880337} because of the following error: The value None could not be cast to float..
Trial 19 failed with value None.
Trial 20 failed with parameters: {'learning_rate': 5.332706400523654e-05, 'n_steps': 2792, 'total_timesteps': 2128637, 'gamma': 0.9419793805555678, 'gae_lambda': 0.954300219996739, 'ent_coef': 0.01141744802355743, 'vf_coef': 0.11571894559689648, 'max_grad_norm': 0.10904585861739728, 'reward_scaling': 3.892113226844526e-05, 'hmax': 65651, 'sharpe_ratio_weight': 0.32638095469276074, 'loss_penalty_weight': 0.3407941839047081} because of the following error: The value None could not be cast to float..
Trial 20 failed with value None.
Trial 21 failed with parameters: {'learning_rate': 8.641596516398162e-05, 'n_steps': 9908, 'total_timesteps': 1452380, 'gamma': 0.9355680692395141, 'gae_lambda': 0.9755925572805819, 'ent_coef': 0.0750245417735609, 'vf_coef': 0.1880867034073506, 'max_grad_norm': 0.39619541514589696, 'reward_scaling': 2.929168375031177e-05, 'hmax': 60223, 'sharpe_ratio_weight': 0.5004914660016674, 'loss_penalty_weight': 0.2777365841974302} because of the following error: The value None could not be cast to float..
Trial 21 failed with value None.
Trial 22 failed with parameters: {'learning_rate': 2.9680799808541628e-05, 'n_steps': 2358, 'total_timesteps': 895474, 'gamma': 0.9663064847280246, 'gae_lambda': 0.9455928114677786, 'ent_coef': 0.040907595956765824, 'vf_coef': 0.12331134886720829, 'max_grad_norm': 0.1808865858571289, 'reward_scaling': 0.0006667994791423818, 'hmax': 63544, 'sharpe_ratio_weight': 0.3757999009402188, 'loss_penalty_weight': 0.13519465669691547} because of the following error: The value None could not be cast to float..
Trial 22 failed with value None.
Trial 23 failed with parameters: {'learning_rate': 2.534907283893621e-05, 'n_steps': 9292, 'total_timesteps': 1725442, 'gamma': 0.9225565482257942, 'gae_lambda': 0.9107521323964008, 'ent_coef': 0.011293472965391342, 'vf_coef': 0.21228903218504494, 'max_grad_norm': 0.10807644177857627, 'reward_scaling': 2.7097926290279893e-05, 'hmax': 97740, 'sharpe_ratio_weight': 0.4063920240396053, 'loss_penalty_weight': 0.130895501885761} because of the following error: The value None could not be cast to float..
Trial 23 failed with value None.
Trial 24 failed with parameters: {'learning_rate': 1.9732046732957477e-05, 'n_steps': 5935, 'total_timesteps': 2882971, 'gamma': 0.9898842646193035, 'gae_lambda': 0.983727810488993, 'ent_coef': 0.08497669962518724, 'vf_coef': 0.16052151061599895, 'max_grad_norm': 0.10880428867189662, 'reward_scaling': 2.1889741330271492e-05, 'hmax': 69829, 'sharpe_ratio_weight': 0.2371115975513469, 'loss_penalty_weight': 0.13885723929462981} because of the following error: The value None could not be cast to float..
Trial 24 failed with value None.
Trial 25 failed with parameters: {'learning_rate': 4.670058076890594e-05, 'n_steps': 3100, 'total_timesteps': 2398679, 'gamma': 0.9153731309121462, 'gae_lambda': 0.9145405794793974, 'ent_coef': 0.047838754247463, 'vf_coef': 0.2253480812598061, 'max_grad_norm': 0.29654027554316986, 'reward_scaling': 0.0008421547134022421, 'hmax': 75692, 'sharpe_ratio_weight': 0.5412681911994567, 'loss_penalty_weight': 0.5643542565335554} because of the following error: The value None could not be cast to float..
Trial 25 failed with value None.
Trial 26 failed with parameters: {'learning_rate': 3.377688554125146e-05, 'n_steps': 2337, 'total_timesteps': 2238084, 'gamma': 0.903088229484059, 'gae_lambda': 0.956052486822039, 'ent_coef': 0.024334373255669683, 'vf_coef': 0.11591032749041827, 'max_grad_norm': 0.36739036548698933, 'reward_scaling': 4.483726414584972e-05, 'hmax': 74103, 'sharpe_ratio_weight': 0.4400464033625214, 'loss_penalty_weight': 0.4787552231151629} because of the following error: The value None could not be cast to float..
Trial 26 failed with value None.
Trial 27 failed with parameters: {'learning_rate': 1.7069901269917572e-05, 'n_steps': 2351, 'total_timesteps': 2520033, 'gamma': 0.9013287096446472, 'gae_lambda': 0.9352487154956877, 'ent_coef': 0.029720697393447588, 'vf_coef': 0.2725568578330549, 'max_grad_norm': 0.20191657531282264, 'reward_scaling': 0.00014893250479142893, 'hmax': 49147, 'sharpe_ratio_weight': 0.3650548600141843, 'loss_penalty_weight': 0.3287663498189746} because of the following error: The value None could not be cast to float..
Trial 27 failed with value None.
Trial 28 failed with parameters: {'learning_rate': 3.7925069632639044e-05, 'n_steps': 8433, 'total_timesteps': 1636379, 'gamma': 0.9451584206710189, 'gae_lambda': 0.9177703440098958, 'ent_coef': 0.024735685714826598, 'vf_coef': 0.24336232682577508, 'max_grad_norm': 0.3918118989623124, 'reward_scaling': 2.5854056659815654e-05, 'hmax': 70336, 'sharpe_ratio_weight': 0.397901388573023, 'loss_penalty_weight': 0.2733910801544067} because of the following error: The value None could not be cast to float..
Trial 28 failed with value None.
Trial 29 failed with parameters: {'learning_rate': 5.05879280363239e-05, 'n_steps': 6457, 'total_timesteps': 1298449, 'gamma': 0.9877708618438948, 'gae_lambda': 0.9041710256739436, 'ent_coef': 0.014533050915237992, 'vf_coef': 0.12696158558882495, 'max_grad_norm': 0.11387578126149965, 'reward_scaling': 0.00011884269427932072, 'hmax': 72989, 'sharpe_ratio_weight': 0.41859931609069073, 'loss_penalty_weight': 0.10759968856227389} because of the following error: The value None could not be cast to float..
Trial 29 failed with value None.
A new study created in memory with name: no-name-78bdd6c9-e893-4fa3-abb3-95b98feebb09
Trial 0 finished with value: 6.854725265577872 and parameters: {'learning_rate': 1.1360388763236516e-05, 'n_steps': 8458, 'total_timesteps': 112125, 'gamma': 0.9555072225763669, 'gae_lambda': 0.9209977777366773, 'ent_coef': 0.02534532165041321, 'vf_coef': 0.13845285852075406, 'max_grad_norm': 0.16618079553230863, 'reward_scaling': 0.000996232198228912, 'hmax': 51639, 'sharpe_ratio_weight': 0.6349294273902955, 'loss_penalty_weight': 0.2795776182695276}. Best is trial 0 with value: 6.854725265577872.
Trial 1 failed with parameters: {'learning_rate': 2.4332153725439384e-05, 'n_steps': 3186, 'total_timesteps': 109568, 'gamma': 0.9860864811994737, 'gae_lambda': 0.9020841875136443, 'ent_coef': 0.029688666263047357, 'vf_coef': 0.1725169728545975, 'max_grad_norm': 0.39282330548237515, 'reward_scaling': 2.2091551749124514e-05, 'hmax': 45092, 'sharpe_ratio_weight': 0.7316018016273785, 'loss_penalty_weight': 0.14594423135049767} because of the following error: KeyboardInterrupt().
Traceback (most recent call last):
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/optuna/study/_optimize.py", line 200, in _run_trial
    value_or_values = func(trial)
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/hyperoptimizer/optunaoptimizer.py", line 362, in objective
    model.learn(total_timesteps=timesteps, callback=callbacks, tb_log_name="a2c_florian_any_name")
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/a2c/a2c.py", line 194, in learn
    return super().learn(
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 259, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 178, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 197, in step
    return self.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 178, in step_wait
    obs, rewards, dones, infos = self.venv.step_wait()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 58, in step_wait
    obs, self.buf_rews[env_idx], terminated, truncated, self.buf_infos[env_idx] = self.envs[env_idx].step(
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/portfolio_bbg.py", line 235, in step
    self.state = self._update_state()
  File "/Users/floriankockler/Documents/GitHub.nosync/quantumai2/env/portfolio_bbg.py", line 333, in _update_state
    if len(self.df.tic.unique()) >1:
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/series.py", line 2194, in unique
    return super().unique()
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/base.py", line 1030, in unique
    result = algorithms.unique1d(values)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/algorithms.py", line 390, in unique
    return unique_with_mask(values)
  File "/Users/floriankockler/anaconda3/envs/py310/lib/python3.10/site-packages/pandas/core/algorithms.py", line 429, in unique_with_mask
    uniques = table.unique(values)
KeyboardInterrupt
Trial 1 failed with value None.
A new study created in memory with name: no-name-bafc0a52-2353-4b18-a8a6-3774393c37d1
Trial 0 finished with value: 63.228476339005155 and parameters: {'learning_rate': 2.170998321785237e-05, 'n_steps': 2373, 'total_timesteps': 19463, 'gamma': 0.9124188011999983, 'gae_lambda': 0.9163248423404295, 'ent_coef': 0.023548496781441407, 'vf_coef': 0.247068974533491, 'max_grad_norm': 0.3960502046292017, 'reward_scaling': 2.9862856382233637e-05, 'hmax': 42968, 'high_profit_bonus': 490, 'partial_sell_bonus': 421}. Best is trial 0 with value: 63.228476339005155.
